## @ingroup Energy-Thermal_Management-Batteries-Heat_Acquisition_Systems
# RCAIDE/Energy/Thermal_Management/Batteries/Heat_Acquisition_Systems/Direct_Air.py
# 
# 
# Created:  Jul 2023, M. Clarke 

# ----------------------------------------------------------------------------------------------------------------------
#  IMPORT
# ----------------------------------------------------------------------------------------------------------------------
  
from RCAIDE.Library.Components import Component  
from RCAIDE.Library.Methods.Thermal_Management.Batteries.Air_Cooled import append_air_cooling_conditions, compute_thermal_performance
from RCAIDE.Library.Attributes.Gases import Air 

# ----------------------------------------------------------------------------------------------------------------------
#  Atmospheric_Air_Convection_Heat_Exchanger
# ----------------------------------------------------------------------------------------------------------------------
## @ingroup Energy-Thermal_Management-Batteries-Heat_Acquisition_Systems
class Air_Cooled(Component):
    """This provides output values for a direct convention heat exchanger of a bettery pack
    
    Assumptions:
    None
    
    Source:
    N/A
    """
    
    def __defaults__(self):  
        self.tag                                      = 'Air_Cooled_Thermal_Management'
        self.cooling_fluid                            = Air()    
        self.cooling_fluid.flowspeed                  = 0.01                                          
        self.convective_heat_transfer_coefficient     = 35.     # [W/m^2K] 
        self.heat_transfer_efficiency                 = 1.0      
        return
    
    
    def append_operating_conditions(self,segment,coolant_line,add_additional_network_equation = False):
        append_air_cooling_conditions(self,segment,coolant_line,add_additional_network_equation)
        return
    def compute_thermal_performance(self,battery,Q_heat_gen,T_cell,state,dt,i): 
        '''Computes the net heat generated by the battery pack with direct air cooling heat 
        acquisition system
        
        Assumtions:
        None
        
        Source
        None 
        
        Inputs:
        self                  - heat acquisition system                         [-]
        battery               - battery pack                                   [-]
        Q_heat_gen            - thermal load generated by battery              [W] 
        T_cell                - temperature of the battery cell                [K]
        state                 - conditions of system                           [-]
        dt                    - time step                                      [s]
        i                     - control point                                  [-]
        
        Outputs 
        Q_heat_gen_tot        - total heat generated by pack                   [W]
        Q_net                 - net heat accumulated in battery pack           [W]
        T_current             - updated battery temperature at new timestep    [K]
        ''' 
        
        HAS_outputs = direct_convection_model(HAS, battery, Q_heat_gen, T_cell, state, dt, i)
         
        return HAS_outputs
        
