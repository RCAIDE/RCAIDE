<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RCAIDE.Library.Methods.Aerodynamics.Vortex_Lattice_Method.generate_vortex_distribution &mdash; RCAIDE 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../../../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../../../_static/documentation_options.js?v=8d563738"></script>
        <script src="../../../../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../../index.html" class="icon icon-home">
            RCAIDE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../modules.html">RCAIDE</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../index.html">RCAIDE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">RCAIDE.Library.Methods.Aerodynamics.Vortex_Lattice_Method.generate_vortex_distribution</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for RCAIDE.Library.Methods.Aerodynamics.Vortex_Lattice_Method.generate_vortex_distribution</h1><div class="highlight"><pre>
<span></span><span class="c1">## @ingroup Library-Methods-Aerodynamics-Common-Fidelity_Zero-Lift</span>
<span class="c1"># generate_vortex_distribution.py</span>
<span class="c1"># </span>
<span class="c1"># Created:  May 2018, M. Clarke</span>
<span class="c1"># Modified: Apr 2020, M. Clarke</span>
<span class="c1">#           Jun 2021, A. Blaufox</span>

<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1">#  Imports</span>
<span class="c1"># ----------------------------------------------------------------------</span>

<span class="c1"># package imports </span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">RCAIDE.Framework.Core</span>                                                 <span class="kn">import</span>  <span class="n">Data</span>
<span class="kn">from</span> <span class="nn">RCAIDE.Library.Components.Wings</span>                                     <span class="kn">import</span> <span class="n">All_Moving_Surface</span>
<span class="kn">from</span> <span class="nn">RCAIDE.Library.Components.Fuselages</span>                                 <span class="kn">import</span> <span class="n">Fuselage</span>
<span class="kn">from</span> <span class="nn">RCAIDE.Library.Components.Nacelles</span>                                  <span class="kn">import</span> <span class="n">Nacelle</span>
<span class="kn">from</span> <span class="nn">RCAIDE.Library.Methods.Aerodynamics.Vortex_Lattice_Method</span>           <span class="kn">import</span> <span class="n">postprocess_VD</span><span class="p">,</span> <span class="n">make_VLM_wings</span> <span class="p">,</span> <span class="n">deflect_control_surface</span>
<span class="kn">from</span> <span class="nn">RCAIDE.Library.Methods.Geometry.Two_Dimensional.Airfoil</span>             <span class="kn">import</span> <span class="n">import_airfoil_geometry</span>
 

<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1">#  Generate Vortex Distribution</span>
<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1">## @ingroup Library-Methods-Aerodynamics-Common-Fidelity_Zero-Lift</span>
<div class="viewcode-block" id="generate_vortex_distribution">
<a class="viewcode-back" href="../../../../../../RCAIDE.Library.Methods.Aerodynamics.Vortex_Lattice_Method.html#RCAIDE.Library.Methods.Aerodynamics.Vortex_Lattice_Method.generate_vortex_distribution.generate_vortex_distribution">[docs]</a>
<span class="k">def</span> <span class="nf">generate_vortex_distribution</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span><span class="n">settings</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; Compute the coordinates of panels, vortices , control points</span>
<span class="sd">    and geometry used to build the influence coefficient matrix. A </span>
<span class="sd">    different discretization (n_sw and n_cw) may be defined for each type</span>
<span class="sd">    of major section (wings and fuselages). </span>
<span class="sd">    </span>
<span class="sd">    Control surfaces are modelled as wings, but adapt their panel density </span>
<span class="sd">    to that of the area in which they reside on their own wing.   </span>

<span class="sd">    Assumptions: </span>
<span class="sd">    Below is a schematic of the coordinates of an arbitrary panel  </span>
<span class="sd">    </span>
<span class="sd">    XA1 ____________________________ XB1    </span>
<span class="sd">       |                            |</span>
<span class="sd">       |        bound vortex        |</span>
<span class="sd">    XAH|  ________________________  |XBH</span>
<span class="sd">       | |           XCH          | |</span>
<span class="sd">       | |                        | |</span>
<span class="sd">       | |                        | |     </span>
<span class="sd">       | |                        | |</span>
<span class="sd">       | |                        | |</span>
<span class="sd">       | |           0 &lt;--control | |       </span>
<span class="sd">       | |          XC     point  | |  </span>
<span class="sd">       | |                        | |</span>
<span class="sd">   XA2 |_|________________________|_|XB2</span>
<span class="sd">         |                        |     </span>
<span class="sd">         |       trailing         |  </span>
<span class="sd">         |   &lt;--  vortex   --&gt;    |  </span>
<span class="sd">         |         legs           | </span>
<span class="sd">             </span>
<span class="sd">    </span>
<span class="sd">    In addition, all control surfaces should be appended directly</span>
<span class="sd">       to the wing, not the wing segments    </span>
<span class="sd">    </span>
<span class="sd">    For control surfaces, &quot;positve&quot; deflection corresponds to the RH rule where the axis of rotation is the OUTBOARD-pointing hinge vector</span>
<span class="sd">    symmetry: the LH rule is applied to the reflected surface for non-ailerons. Ailerons follow a RH rule for both sides</span>
<span class="sd">    </span>
<span class="sd">    Source:  </span>
<span class="sd">    None</span>

<span class="sd">    Inputs:</span>
<span class="sd">    geometry.wings                                [Unitless]  </span>
<span class="sd">    settings.floating_point_precision             [np.dtype]</span>
<span class="sd">    </span>
<span class="sd">    Of the following settings, the user should define either the number_ atrributes or the wing_ and fuse_ attributes.</span>
<span class="sd">    settings.number_spanwise_vortices             - a base number of vortices to be applied to both wings and fuselages</span>
<span class="sd">    settings.number_chordwise_vortices            - a base number of vortices to be applied to both wings and fuselages</span>
<span class="sd">    settings.wing_spanwise_vortices               - the number of vortices to be applied to only the wings</span>
<span class="sd">    settings.wing_chordwise_vortices              - the number of vortices to be applied to only the wings</span>
<span class="sd">    settings.fuselage_spanwise_vortices           - the number of vortices to be applied to only the fuslages</span>
<span class="sd">    settings.fuselage_chordwise_vortices          - the number of vortices to be applied to only the fuselages </span>
<span class="sd">       </span>
<span class="sd">    Outputs:                                   </span>
<span class="sd">    VD - vehicle vortex distribution              [Unitless] </span>

<span class="sd">    Properties Used:</span>
<span class="sd">    N/A </span>
<span class="sd">         </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># ---------------------------------------------------------------------------------------</span>
    <span class="c1"># STEP 0: Unpack settings</span>
    <span class="c1"># ---------------------------------------------------------------------------------------        </span>
    <span class="c1">#unpack other settings----------------------------------------------------</span>
    <span class="n">spc</span>            <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">spanwise_cosine_spacing</span>
    <span class="n">model_fuselage</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">model_fuselage</span>
    <span class="n">model_nacelle</span>  <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">model_nacelle</span>
    <span class="n">precision</span>      <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">floating_point_precision</span>
    
    <span class="n">show_prints</span>    <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">verbose</span> <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;verbose&#39;</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">else</span> <span class="kc">False</span>
    
    <span class="c1"># unpack discretization settings------------------------------------------</span>
    <span class="n">n_sw_global</span>    <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">number_spanwise_vortices</span>  
    <span class="n">n_cw_global</span>    <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">number_chordwise_vortices</span>
    <span class="n">n_sw_wing</span>      <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">wing_spanwise_vortices</span>  
    <span class="n">n_cw_wing</span>      <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">wing_chordwise_vortices</span>
    <span class="n">n_sw_fuse</span>      <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">fuselage_spanwise_vortices</span>  
    <span class="n">n_cw_fuse</span>      <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">fuselage_chordwise_vortices</span>
    
    <span class="c1">#make sure n_cw and n_sw are both defined or not defined</span>
    <span class="n">invalid_global_n</span>   <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">n_sw_global</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">n_cw_global</span><span class="p">)</span> 
    <span class="n">invalid_wing_n</span>     <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">n_sw_wing</span><span class="p">)</span>   <span class="o">!=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">n_cw_wing</span><span class="p">)</span>
    <span class="n">invalid_fuse_n</span>     <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">n_sw_fuse</span><span class="p">)</span>   <span class="o">!=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">n_cw_fuse</span><span class="p">)</span>
    <span class="n">invalid_separate_n</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">n_sw_wing</span><span class="p">)</span>   <span class="o">!=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">n_sw_fuse</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">invalid_global_n</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;If using global surface discretization, both n_sw and n_cw must be defined&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">invalid_wing_n</span> <span class="ow">or</span> <span class="n">invalid_fuse_n</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;If using separate surface discretization, all n_sw and n_cw values must be defined&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">invalid_separate_n</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;If using separate surface discretization, both wing and fuselage discretization must be defined&#39;</span><span class="p">)</span>
    
    <span class="c1">#make sure that global and separate settings aren&#39;t both defined</span>
    <span class="n">global_n_defined</span>   <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">n_sw_global</span><span class="p">)</span> 
    <span class="n">separate_n_defined</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">n_sw_wing</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">global_n_defined</span> <span class="o">==</span> <span class="n">separate_n_defined</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;Specify either global or separate discretization&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">global_n_defined</span><span class="p">:</span>
        <span class="n">n_sw_wing</span> <span class="o">=</span> <span class="n">n_sw_global</span>
        <span class="n">n_cw_wing</span> <span class="o">=</span> <span class="n">n_cw_global</span>
        <span class="n">n_sw_fuse</span> <span class="o">=</span> <span class="n">n_sw_global</span>
        <span class="n">n_cw_fuse</span> <span class="o">=</span> <span class="n">n_cw_global</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1">#separate_n_defined</span>
        <span class="c1">#everything is already set up to use separate discretization</span>
        <span class="k">pass</span>
    
    <span class="c1"># ---------------------------------------------------------------------------------------</span>
    <span class="c1"># STEP 1: Define empty vectors for coordinates of panes, control points and bound vortices</span>
    <span class="c1"># ---------------------------------------------------------------------------------------</span>
    <span class="n">VD</span> <span class="o">=</span> <span class="n">Data</span><span class="p">()</span>

    <span class="n">VD</span><span class="o">.</span><span class="n">XAH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">YAH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">ZAH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">XBH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">YBH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">ZBH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">XCH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">YCH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">ZCH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>     
    <span class="n">VD</span><span class="o">.</span><span class="n">XA1</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">YA1</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>  
    <span class="n">VD</span><span class="o">.</span><span class="n">ZA1</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">XA2</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">YA2</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>    
    <span class="n">VD</span><span class="o">.</span><span class="n">ZA2</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>    
    <span class="n">VD</span><span class="o">.</span><span class="n">XB1</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">YB1</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>  
    <span class="n">VD</span><span class="o">.</span><span class="n">ZB1</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">XB2</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">YB2</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>    
    <span class="n">VD</span><span class="o">.</span><span class="n">ZB2</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>     
    <span class="n">VD</span><span class="o">.</span><span class="n">XAC</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">YAC</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">ZAC</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span> 
    <span class="n">VD</span><span class="o">.</span><span class="n">XBC</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">YBC</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">ZBC</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span> 
    <span class="n">VD</span><span class="o">.</span><span class="n">XC_TE</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">YC_TE</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">ZC_TE</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>     
    <span class="n">VD</span><span class="o">.</span><span class="n">XA_TE</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">YA_TE</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">ZA_TE</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span> 
    <span class="n">VD</span><span class="o">.</span><span class="n">XB_TE</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">YB_TE</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">ZB_TE</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>  
    <span class="n">VD</span><span class="o">.</span><span class="n">XC</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">YC</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">ZC</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>    
    <span class="n">VD</span><span class="o">.</span><span class="n">FUS_XC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">FUS_YC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">FUS_ZC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>      
    <span class="n">VD</span><span class="o">.</span><span class="n">CS</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span> 
    <span class="n">VD</span><span class="o">.</span><span class="n">X</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">Y</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">Z</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">Y_SW</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">DY</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span> 

    <span class="c1"># empty vectors necessary for arbitrary discretization dimensions</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">n_w</span>              <span class="o">=</span> <span class="mi">0</span>                            <span class="c1"># number of wings counter (refers to wings, fuselages or other structures)  </span>
    <span class="n">VD</span><span class="o">.</span><span class="n">n_cp</span>             <span class="o">=</span> <span class="mi">0</span>                            <span class="c1"># number of bound vortices (panels) counter </span>
    <span class="n">VD</span><span class="o">.</span><span class="n">n_sw</span>             <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span> <span class="c1"># array of the number of spanwise  strips in each wing</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">n_cw</span>             <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span> <span class="c1"># array of the number of chordwise panels per strip in each wing</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">chordwise_breaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span> <span class="c1"># indices of the first panel in every strip      (given a list of all panels)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">spanwise_breaks</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span> <span class="c1"># indices of the first strip of panels in a wing (given chordwise_breaks)    </span>
    <span class="n">VD</span><span class="o">.</span><span class="n">symmetric_wings</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">surface_ID</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span> 
    <span class="n">VD</span><span class="o">.</span><span class="n">surface_ID_full</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>     
    
    <span class="n">VD</span><span class="o">.</span><span class="n">leading_edge_indices</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>      <span class="c1"># bool array of leading  edge indices (all false except for panels at leading  edge)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">trailing_edge_indices</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>      <span class="c1"># bool array of trailing edge indices (all false except for panels at trailing edge)    </span>
    <span class="n">VD</span><span class="o">.</span><span class="n">panels_per_strip</span>          <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>  <span class="c1"># array of the number of panels per strip (RNMAX); this is assigned for all panels  </span>
    <span class="n">VD</span><span class="o">.</span><span class="n">chordwise_panel_number</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>  <span class="c1"># array of panels&#39; numbers in their strips.     </span>
    <span class="n">VD</span><span class="o">.</span><span class="n">chord_lengths</span>             <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span> <span class="c1"># Chord length, this is assigned for all panels.</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">tangent_incidence_angle</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span> <span class="c1"># Tangent Incidence Angles of the chordwise strip. LE to TE, ZETA</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">exposed_leading_edge_flag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>  <span class="c1"># 0 or 1 per strip. 0 turns off leading edge suction for non-slat control surfaces</span>
    
    <span class="c1"># ---------------------------------------------------------------------------------------</span>
    <span class="c1"># STEP 2: Unpack aircraft wing geometry </span>
    <span class="c1"># ---------------------------------------------------------------------------------------    </span>
    <span class="n">VD</span><span class="o">.</span><span class="n">wing_areas</span>  <span class="o">=</span> <span class="p">[]</span> <span class="c1"># instantiate wing areas</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">vortex_lift</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">counter</span>     <span class="o">=</span> <span class="mi">0</span>
    
    <span class="c1">#reformat/preprocess wings and control surfaces for VLM panelization</span>
    <span class="n">VLM_wings</span> <span class="o">=</span> <span class="n">make_VLM_wings</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">VLM_wings</span> <span class="o">=</span> <span class="n">VLM_wings</span>
    
    <span class="c1">#generate panelization for each wing. Wings first, then control surface wings</span>
    <span class="k">for</span> <span class="n">wing</span> <span class="ow">in</span> <span class="n">VD</span><span class="o">.</span><span class="n">VLM_wings</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">wing</span><span class="o">.</span><span class="n">is_a_control_surface</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">show_prints</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;discretizing &#39;</span> <span class="o">+</span> <span class="n">wing</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span> 
            <span class="n">VD</span><span class="p">,</span> <span class="n">wing</span> <span class="o">=</span> <span class="n">generate_wing_vortex_distribution</span><span class="p">(</span><span class="n">VD</span><span class="p">,</span><span class="n">wing</span><span class="p">,</span><span class="n">n_cw_wing</span><span class="p">,</span><span class="n">n_sw_wing</span><span class="p">,</span><span class="n">spc</span><span class="p">,</span><span class="n">precision</span><span class="p">)</span>    
                    
    <span class="k">for</span> <span class="n">wing</span> <span class="ow">in</span> <span class="n">VD</span><span class="o">.</span><span class="n">VLM_wings</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">wing</span><span class="o">.</span><span class="n">is_a_control_surface</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">show_prints</span><span class="p">:</span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;discretizing &#39;</span> <span class="o">+</span> <span class="n">wing</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span>
            <span class="n">VD</span><span class="p">,</span> <span class="n">wing</span> <span class="o">=</span> <span class="n">generate_wing_vortex_distribution</span><span class="p">(</span><span class="n">VD</span><span class="p">,</span><span class="n">wing</span><span class="p">,</span><span class="n">n_cw_wing</span><span class="p">,</span><span class="n">n_sw_wing</span><span class="p">,</span><span class="n">spc</span><span class="p">,</span><span class="n">precision</span><span class="p">)</span>     
            
            
    <span class="c1"># ---------------------------------------------------------------------------------------</span>
    <span class="c1"># STEP 8: Unpack aircraft nacelle geometry</span>
    <span class="c1"># ---------------------------------------------------------------------------------------      </span>
    <span class="n">VD</span><span class="o">.</span><span class="n">wing_areas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">wing_areas</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">n_fus</span>      <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">nac</span> <span class="ow">in</span> <span class="n">geometry</span><span class="o">.</span><span class="n">nacelles</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">show_prints</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;discretizing &#39;</span> <span class="o">+</span> <span class="n">nac</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span>
        <span class="n">VD</span> <span class="o">=</span> <span class="n">generate_fuselage_and_nacelle_vortex_distribution</span><span class="p">(</span><span class="n">VD</span><span class="p">,</span><span class="n">nac</span><span class="p">,</span><span class="n">n_cw_fuse</span><span class="p">,</span><span class="n">n_sw_fuse</span><span class="p">,</span><span class="n">precision</span><span class="p">,</span><span class="n">model_nacelle</span><span class="p">)</span>


    <span class="c1"># ---------------------------------------------------------------------------------------</span>
    <span class="c1"># STEP 9: Unpack aircraft fuselage geometry</span>
    <span class="c1"># ---------------------------------------------------------------------------------------</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">wing_areas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">wing_areas</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">fus</span> <span class="ow">in</span> <span class="n">geometry</span><span class="o">.</span><span class="n">fuselages</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">show_prints</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;discretizing &#39;</span> <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">tag</span><span class="p">)</span>
        <span class="n">VD</span> <span class="o">=</span> <span class="n">generate_fuselage_and_nacelle_vortex_distribution</span><span class="p">(</span><span class="n">VD</span><span class="p">,</span><span class="n">fus</span><span class="p">,</span><span class="n">n_cw_fuse</span><span class="p">,</span><span class="n">n_sw_fuse</span><span class="p">,</span><span class="n">precision</span><span class="p">,</span><span class="n">model_fuselage</span><span class="p">)</span>


    <span class="c1"># ---------------------------------------------------------------------------------------</span>
    <span class="c1"># STEP 10: Deflect Control Surfaces</span>
    <span class="c1"># ---------------------------------------------------------------------------------------      </span>
    <span class="k">for</span> <span class="n">wing</span> <span class="ow">in</span> <span class="n">VD</span><span class="o">.</span><span class="n">VLM_wings</span><span class="p">:</span>
        <span class="n">wing_is_all_moving</span> <span class="o">=</span> <span class="p">(</span><span class="ow">not</span> <span class="n">wing</span><span class="o">.</span><span class="n">is_a_control_surface</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">wing</span><span class="o">.</span><span class="n">wing_type</span><span class="p">,</span> <span class="n">All_Moving_Surface</span><span class="p">)</span>        
        <span class="k">if</span> <span class="n">wing</span><span class="o">.</span><span class="n">is_a_control_surface</span> <span class="ow">or</span> <span class="n">wing_is_all_moving</span><span class="p">:</span>
            <span class="c1"># Deflect the control surface</span>
            <span class="n">VD</span><span class="p">,</span> <span class="n">wing</span> <span class="o">=</span> <span class="n">deflect_control_surface</span><span class="p">(</span><span class="n">VD</span><span class="p">,</span> <span class="n">wing</span><span class="p">)</span>
            
    <span class="c1"># ---------------------------------------------------------------------------------------</span>
    <span class="c1"># STEP 11: Postprocess VD information</span>
    <span class="c1"># ---------------------------------------------------------------------------------------  </span>
    
    <span class="n">VD</span> <span class="o">=</span> <span class="n">postprocess_VD</span><span class="p">(</span><span class="n">VD</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>
    
    <span class="c1"># pack VD into geometry</span>
    <span class="n">geometry</span><span class="o">.</span><span class="n">vortex_distribution</span> <span class="o">=</span> <span class="n">VD</span>
    
    <span class="k">if</span> <span class="n">show_prints</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;finish discretization&#39;</span><span class="p">)</span>     
    
    <span class="k">return</span> <span class="n">VD</span> </div>



<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1">#  Discretize Wings</span>
<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1">## @ingroup Library-Methods-Aerodynamics-Common-Fidelity_Zero-Lift</span>
<div class="viewcode-block" id="generate_wing_vortex_distribution">
<a class="viewcode-back" href="../../../../../../RCAIDE.Library.Methods.Aerodynamics.Vortex_Lattice_Method.html#RCAIDE.Library.Methods.Aerodynamics.Vortex_Lattice_Method.generate_vortex_distribution.generate_wing_vortex_distribution">[docs]</a>
<span class="k">def</span> <span class="nf">generate_wing_vortex_distribution</span><span class="p">(</span><span class="n">VD</span><span class="p">,</span><span class="n">wing</span><span class="p">,</span><span class="n">n_cw</span><span class="p">,</span><span class="n">n_sw</span><span class="p">,</span><span class="n">spc</span><span class="p">,</span><span class="n">precision</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This generates vortex distribution points for the given wing </span>

<span class="sd">    Assumptions: </span>
<span class="sd">    The wing is segmented and was made or modified by make_VLM_wings()</span>
<span class="sd">    </span>
<span class="sd">    For control surfaces, &quot;positve&quot; deflection corresponds to the RH rule where the axis of rotation is the OUTBOARD-pointing hinge vector</span>
<span class="sd">    symmetry: the LH rule is applied to the reflected surface for non-ailerons. Ailerons follow a RH rule for both sides</span>
<span class="sd">    </span>
<span class="sd">    The hinge_vector will only ever be calcualted on the first strip of any control/all-moving surface. It is assumed that all control</span>
<span class="sd">    surfaces are trapezoids, thus needing only one hinge, and that all all-moving surfaces have exactly one point of rotation.</span>

<span class="sd">    Source:   </span>
<span class="sd">    None</span>
<span class="sd">    </span>
<span class="sd">    Inputs:   </span>
<span class="sd">    VD                   - vortex distribution</span>
<span class="sd">    wing                 - a Data object made or modified by make_VLM_wings() to mimick a Wing object</span>
<span class="sd">    </span>
<span class="sd">    Properties Used:</span>
<span class="sd">    N/A</span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">wings</span> <span class="o">=</span> <span class="n">VD</span><span class="o">.</span><span class="n">VLM_wings</span>
    
    <span class="c1"># get geometry of wing  </span>
    <span class="n">span</span>          <span class="o">=</span> <span class="n">wing</span><span class="o">.</span><span class="n">spans</span><span class="o">.</span><span class="n">projected</span>
    <span class="n">root_chord</span>    <span class="o">=</span> <span class="n">wing</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">root</span>
    <span class="n">tip_chord</span>     <span class="o">=</span> <span class="n">wing</span><span class="o">.</span><span class="n">chords</span><span class="o">.</span><span class="n">tip</span>
    <span class="n">sweep_qc</span>      <span class="o">=</span> <span class="n">wing</span><span class="o">.</span><span class="n">sweeps</span><span class="o">.</span><span class="n">quarter_chord</span>
    <span class="n">sweep_le</span>      <span class="o">=</span> <span class="n">wing</span><span class="o">.</span><span class="n">sweeps</span><span class="o">.</span><span class="n">leading_edge</span> 
    <span class="n">twist_rc</span>      <span class="o">=</span> <span class="n">wing</span><span class="o">.</span><span class="n">twists</span><span class="o">.</span><span class="n">root</span>
    <span class="n">twist_tc</span>      <span class="o">=</span> <span class="n">wing</span><span class="o">.</span><span class="n">twists</span><span class="o">.</span><span class="n">tip</span>
    <span class="n">dihedral</span>      <span class="o">=</span> <span class="n">wing</span><span class="o">.</span><span class="n">dihedral</span>
    <span class="n">sym_para</span>      <span class="o">=</span> <span class="n">wing</span><span class="o">.</span><span class="n">symmetric</span> 
    <span class="n">vertical_wing</span> <span class="o">=</span> <span class="n">wing</span><span class="o">.</span><span class="n">vertical</span>
    <span class="n">wing_origin</span>   <span class="o">=</span> <span class="n">wing</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">VD</span><span class="o">.</span><span class="n">vortex_lift</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wing</span><span class="o">.</span><span class="n">vortex_lift</span><span class="p">)</span>

    <span class="c1"># determine if vehicle has symmetry </span>
    <span class="k">if</span> <span class="n">sym_para</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span>
        <span class="n">span</span> <span class="o">=</span> <span class="n">span</span><span class="o">/</span><span class="mi">2</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">vortex_lift</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wing</span><span class="o">.</span><span class="n">vortex_lift</span><span class="p">)</span>
        
    <span class="n">VD</span><span class="o">.</span><span class="n">counter</span>  <span class="o">+=</span><span class="mi">1</span>
    <span class="n">wing</span><span class="o">.</span><span class="n">surface_ID</span> <span class="o">=</span> <span class="n">VD</span><span class="o">.</span><span class="n">counter</span><span class="o">*</span><span class="mi">1</span>

    <span class="c1"># ---------------------------------------------------------------------------------------</span>
    <span class="c1"># STEP 3: Get discretization control variables  </span>
    <span class="c1"># ---------------------------------------------------------------------------------------</span>
    <span class="c1"># get number of spanwise and chordwise panels for this wing</span>
    <span class="n">n_sw</span> <span class="o">=</span> <span class="n">n_sw</span> <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">wing</span><span class="o">.</span><span class="n">is_a_control_surface</span><span class="p">)</span> <span class="k">else</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wing</span><span class="o">.</span><span class="n">y_coords_required</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">n_cw</span> <span class="o">=</span> <span class="n">n_cw</span> <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">wing</span><span class="o">.</span><span class="n">is_a_control_surface</span><span class="p">)</span> <span class="k">else</span> <span class="nb">max</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">wing</span><span class="o">.</span><span class="n">chord_fraction</span><span class="o">*</span><span class="n">n_cw</span><span class="p">)),</span><span class="mi">2</span><span class="p">)</span>  
    
    <span class="c1"># get y_coordinates (y-locations of the edges of each strip in wing-local coords)</span>
    <span class="k">if</span> <span class="n">spc</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> <span class="c1"># discretize wing using cosine spacing     </span>
        <span class="n">n</span>               <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>         <span class="c1"># vectorize</span>
        <span class="n">thetan</span>          <span class="o">=</span> <span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>                 <span class="c1"># angular stations</span>
        <span class="n">y_coordinates</span>   <span class="o">=</span> <span class="n">span</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">thetan</span><span class="p">)</span>                  <span class="c1"># y locations based on the angular spacing</span>
    <span class="k">else</span><span class="p">:</span>           <span class="c1"># discretize wing using linear spacing </span>
        <span class="n">y_coordinates</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">span</span><span class="p">,</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> 

    <span class="c1"># get span_breaks object</span>
    <span class="n">span_breaks</span>   <span class="o">=</span> <span class="n">wing</span><span class="o">.</span><span class="n">span_breaks</span>
    <span class="n">n_breaks</span>      <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">span_breaks</span><span class="p">)</span>

    <span class="c1"># ---------------------------------------------------------------------------------------</span>
    <span class="c1"># STEP 4: Setup span_break and section arrays. A &#39;section&#39; is the trapezoid between two</span>
    <span class="c1">#         span_breaks. A &#39;span_break&#39; is described in the file make_VLM_wings.py</span>
    <span class="c1"># ---------------------------------------------------------------------------------------</span>
    <span class="n">break_chord</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_breaks</span><span class="p">)</span>
    <span class="n">break_twist</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_breaks</span><span class="p">)</span>
    <span class="n">break_sweep</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_breaks</span><span class="p">)</span>
    <span class="n">break_dihedral</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_breaks</span><span class="p">)</span>
    <span class="n">break_camber_xs</span>   <span class="o">=</span> <span class="p">[]</span> 
    <span class="n">break_camber_zs</span>   <span class="o">=</span> <span class="p">[]</span>
    <span class="n">break_x_offset</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_breaks</span><span class="p">)</span>
    <span class="n">break_z_offset</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_breaks</span><span class="p">)</span>
    <span class="n">break_spans</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_breaks</span><span class="p">)</span> 
    <span class="n">section_span</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_breaks</span><span class="p">)</span>
    <span class="n">section_area</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_breaks</span><span class="p">)</span>
    <span class="n">section_LE_cut</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_breaks</span><span class="p">)</span>
    <span class="n">section_TE_cut</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_breaks</span><span class="p">)</span>

    <span class="c1"># ---------------------------------------------------------------------------------------</span>
    <span class="c1"># STEP 5:  Obtain sweep, chord, dihedral and twist at the beginning/end of each break.</span>
    <span class="c1">#          If applicable, append airfoil section VD and flap/aileron deflection angles.</span>
    <span class="c1"># --------------------------------------------------------------------------------------- </span>
    <span class="k">for</span> <span class="n">i_break</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_breaks</span><span class="p">):</span>   
        <span class="n">break_spans</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span>    <span class="o">=</span> <span class="n">span_breaks</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span><span class="o">.</span><span class="n">span_fraction</span><span class="o">*</span><span class="n">span</span>  
        <span class="n">break_chord</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span>    <span class="o">=</span> <span class="n">span_breaks</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span><span class="o">.</span><span class="n">local_chord</span>
        <span class="n">break_twist</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span>    <span class="o">=</span> <span class="n">span_breaks</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span><span class="o">.</span><span class="n">twist</span>
        <span class="n">break_dihedral</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">=</span> <span class="n">span_breaks</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span><span class="o">.</span><span class="n">dihedral_outboard</span>                    

        <span class="c1"># get leading edge sweep. make_VLM wings should have precomputed this for all span_breaks</span>
        <span class="n">is_not_last_break</span>    <span class="o">=</span> <span class="p">(</span><span class="n">i_break</span> <span class="o">!=</span> <span class="n">n_breaks</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">break_sweep</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">=</span> <span class="n">span_breaks</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span><span class="o">.</span><span class="n">sweep_outboard_LE</span> <span class="k">if</span> <span class="n">is_not_last_break</span> <span class="k">else</span> <span class="mi">0</span>

        <span class="c1"># find span and area. All span_break offsets should be calculated in make_VLM_wings</span>
        <span class="k">if</span> <span class="n">i_break</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">section_span</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span>   <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">break_x_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>  
            <span class="n">break_z_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>       
        <span class="k">else</span><span class="p">:</span>
            <span class="n">section_span</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span>   <span class="o">=</span> <span class="n">break_spans</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">-</span> <span class="n">break_spans</span><span class="p">[</span><span class="n">i_break</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">section_area</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span>   <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">break_chord</span><span class="p">[</span><span class="n">i_break</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">break_chord</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span><span class="o">*</span><span class="n">section_span</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span>
            <span class="n">break_x_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">=</span> <span class="n">span_breaks</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span><span class="o">.</span><span class="n">x_offset</span>
            <span class="n">break_z_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">=</span> <span class="n">span_breaks</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span><span class="o">.</span><span class="n">dih_offset</span>

        <span class="c1"># Get airfoil section VD  </span>
        <span class="k">if</span> <span class="n">span_breaks</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span><span class="o">.</span><span class="n">Airfoil</span><span class="p">:</span> 
            <span class="n">airfoil_geo_data</span> <span class="o">=</span> <span class="n">import_airfoil_geometry</span><span class="p">(</span><span class="n">span_breaks</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span><span class="o">.</span><span class="n">Airfoil</span><span class="p">[</span><span class="n">span_breaks</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span><span class="o">.</span><span class="n">Airfoil</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">coordinate_file</span><span class="p">)</span> 
            <span class="n">break_camber_zs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">airfoil_geo_data</span><span class="o">.</span><span class="n">camber_coordinates</span><span class="p">)</span>
            <span class="n">break_camber_xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">airfoil_geo_data</span><span class="o">.</span><span class="n">x_lower_surface</span><span class="p">)</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="n">break_camber_zs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>              
            <span class="n">break_camber_xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span> 

        <span class="c1"># Get control surface leading and trailing edge cute cuts: section__cuts[-1] should never be used in the following code</span>
        <span class="n">section_LE_cut</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">=</span> <span class="n">span_breaks</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span><span class="o">.</span><span class="n">cuts</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">section_TE_cut</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">=</span> <span class="n">span_breaks</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span><span class="o">.</span><span class="n">cuts</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">VD</span><span class="o">.</span><span class="n">wing_areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">section_area</span><span class="p">[:],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">sym_para</span> <span class="ow">is</span> <span class="kc">True</span> <span class="p">:</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">wing_areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">section_area</span><span class="p">[:],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>            

    <span class="c1">#Shift spanwise vortices onto section breaks  </span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_coordinates</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n_breaks</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Not enough spanwise VLM stations for segment breaks&#39;</span><span class="p">)</span>

    <span class="n">y_coords_required</span> <span class="o">=</span> <span class="n">break_spans</span> <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">wing</span><span class="o">.</span><span class="n">is_a_control_surface</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">wing</span><span class="o">.</span><span class="n">y_coords_required</span><span class="p">))</span>  <span class="c1">#control surfaces have additional required y_coords  </span>
    <span class="n">shifted_idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_coordinates</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">y_req</span> <span class="ow">in</span> <span class="n">y_coords_required</span><span class="p">:</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_coordinates</span> <span class="o">-</span> <span class="n">y_req</span><span class="p">)</span> <span class="o">+</span> <span class="n">shifted_idxs</span><span class="p">)</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span> <span class="c1">#index of y-coord nearest to the span break</span>
        <span class="n">shifted_idxs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span> 
        <span class="n">y_coordinates</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_req</span>

    <span class="n">y_coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">y_coordinates</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">y_req</span> <span class="ow">in</span> <span class="n">y_coords_required</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">y_req</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">y_coordinates</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;VLM did not capture all section breaks&#39;</span><span class="p">)</span>  
    
    <span class="c1"># ---------------------------------------------------------------------------------------</span>
    <span class="c1"># STEP 6: Define coordinates of panels horseshoe vortices and control points </span>
    <span class="c1"># --------------------------------------------------------------------------------------- </span>
    <span class="n">y_a</span>   <span class="o">=</span> <span class="n">y_coordinates</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
    <span class="n">y_b</span>   <span class="o">=</span> <span class="n">y_coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>             
    <span class="n">del_y</span> <span class="o">=</span> <span class="n">y_coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">y_coordinates</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
    
    <span class="c1"># Let relevant control surfaces know which y-coords they are required to have----------------------------------</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">wing</span><span class="o">.</span><span class="n">is_a_control_surface</span><span class="p">:</span>
        <span class="n">i_break</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">idx_y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sw</span><span class="p">):</span>
            <span class="n">span_break</span> <span class="o">=</span> <span class="n">span_breaks</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span>
            <span class="n">cs_IDs</span>     <span class="o">=</span> <span class="n">span_break</span><span class="o">.</span><span class="n">cs_IDs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#only the outboard control surfaces</span>
            <span class="n">y_coord</span>    <span class="o">=</span> <span class="n">y_coordinates</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span>
            
            <span class="k">for</span> <span class="n">cs_ID</span> <span class="ow">in</span> <span class="n">cs_IDs</span><span class="p">[</span><span class="n">cs_IDs</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]:</span>
                <span class="n">cs_tag</span>     <span class="o">=</span> <span class="n">wing</span><span class="o">.</span><span class="n">tag</span> <span class="o">+</span> <span class="s1">&#39;__cs_id_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cs_ID</span><span class="p">)</span>
                <span class="n">cs_wing</span>    <span class="o">=</span> <span class="n">wings</span><span class="p">[</span><span class="n">cs_tag</span><span class="p">]</span>
                <span class="n">rel_offset</span> <span class="o">=</span> <span class="n">cs_wing</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">wing</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">vertical_wing</span> <span class="k">else</span> <span class="n">cs_wing</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">wing</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">cs_wing</span><span class="o">.</span><span class="n">y_coords_required</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_coord</span> <span class="o">-</span> <span class="n">rel_offset</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">y_coordinates</span><span class="p">[</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">break_spans</span><span class="p">[</span><span class="n">i_break</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span> 
                <span class="n">i_break</span> <span class="o">+=</span> <span class="mi">1</span>
            
    
    <span class="c1"># -------------------------------------------------------------------------------------------------------------</span>
    <span class="c1"># Run the strip contruction loop again if wing is symmetric. </span>
    <span class="c1"># Reflection plane = x-y plane for vertical wings. Otherwise, reflection plane = x-z plane</span>
    <span class="n">signs</span>         <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># acts as a multiplier for symmetry. -1 is only ever used for symmetric wings</span>
    <span class="n">symmetry_mask</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span><span class="n">sym_para</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">sym_sign</span> <span class="ow">in</span> <span class="n">signs</span><span class="p">[</span><span class="n">symmetry_mask</span><span class="p">]:</span>
        <span class="c1"># create empty vectors for coordinates </span>
        <span class="n">xah</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
        <span class="n">yah</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
        <span class="n">zah</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
        <span class="n">xbh</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
        <span class="n">ybh</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
        <span class="n">zbh</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>    
        <span class="n">xch</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
        <span class="n">ych</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
        <span class="n">zch</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>    
        <span class="n">xa1</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
        <span class="n">ya1</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
        <span class="n">za1</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
        <span class="n">xa2</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
        <span class="n">ya2</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
        <span class="n">za2</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>    
        <span class="n">xb1</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
        <span class="n">yb1</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
        <span class="n">zb1</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
        <span class="n">xb2</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span> 
        <span class="n">yb2</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span> 
        <span class="n">zb2</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>    
        <span class="n">xac</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
        <span class="n">yac</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
        <span class="n">zac</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>    
        <span class="n">xbc</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
        <span class="n">ybc</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
        <span class="n">zbc</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>  
        <span class="n">xc</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span> 
        <span class="n">yc</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span> 
        <span class="n">zc</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span> 
        <span class="n">x</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="c1"># may have to change to make space for split if control surfaces are allowed to have more than two Segments</span>
        <span class="n">y</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> 
        <span class="n">z</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>         
        <span class="n">cs_w</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_sw</span><span class="p">)</span>        
        
        <span class="c1"># adjust origin for symmetry with special case for vertical symmetry</span>
        <span class="n">wing_origin_x</span> <span class="o">=</span> <span class="n">wing_origin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">wing_origin_y</span> <span class="o">=</span> <span class="n">wing_origin</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">vertical_wing</span><span class="p">)</span><span class="o">*</span><span class="n">sym_sign</span><span class="o">+</span><span class="n">vertical_wing</span><span class="p">)</span>
        <span class="n">wing_origin_z</span> <span class="o">=</span> <span class="n">wing_origin</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">vertical_wing</span><span class="p">)</span><span class="o">+</span><span class="n">sym_sign</span><span class="o">*</span><span class="n">vertical_wing</span><span class="p">)</span>
            
        <span class="c1"># ---------------------------------------------------------------------------------------------------------</span>
        <span class="c1"># Loop over each strip of panels in the wing</span>
        <span class="n">i_break</span> <span class="o">=</span> <span class="mi">0</span>           
        <span class="k">for</span> <span class="n">idx_y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sw</span><span class="p">):</span>
            <span class="c1"># define basic geometric values------------------------------------------------------------------------</span>
            <span class="c1"># inboard, outboard, and central panel values</span>
            <span class="n">eta_a</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_a</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span> <span class="o">-</span> <span class="n">break_spans</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span>  
            <span class="n">eta_b</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_b</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span> <span class="o">-</span> <span class="n">break_spans</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span> 
            <span class="n">eta</span>   <span class="o">=</span> <span class="p">(</span><span class="n">y_b</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span> <span class="o">-</span> <span class="n">del_y</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">break_spans</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span> 
            
            <span class="c1"># Inverted wing</span>
            <span class="n">wing</span><span class="o">.</span><span class="n">inverted_wing</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">break_dihedral</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    
            <span class="n">segment_chord_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="n">break_chord</span><span class="p">[</span><span class="n">i_break</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">break_chord</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span><span class="o">/</span><span class="n">section_span</span><span class="p">[</span><span class="n">i_break</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">segment_twist_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="n">break_twist</span><span class="p">[</span><span class="n">i_break</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">break_twist</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span><span class="o">/</span><span class="n">section_span</span><span class="p">[</span><span class="n">i_break</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    
            <span class="n">wing_chord_section_a</span>  <span class="o">=</span> <span class="n">break_chord</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">eta_a</span><span class="o">*</span><span class="n">segment_chord_ratio</span><span class="p">)</span> 
            <span class="n">wing_chord_section_b</span>  <span class="o">=</span> <span class="n">break_chord</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">eta_b</span><span class="o">*</span><span class="n">segment_chord_ratio</span><span class="p">)</span>
            <span class="n">wing_chord_section</span>    <span class="o">=</span> <span class="n">break_chord</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">eta</span><span class="o">*</span><span class="n">segment_chord_ratio</span><span class="p">)</span>
    
            <span class="c1"># x-positions based on whether the wing needs &#39;cuts&#39; for its control sufaces</span>
            <span class="n">nondim_x_stations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="n">section_LE_cut</span><span class="p">[</span><span class="n">i_break</span><span class="p">],</span> <span class="n">section_TE_cut</span><span class="p">[</span><span class="n">i_break</span><span class="p">]])</span>
            <span class="n">x_stations_a</span>      <span class="o">=</span> <span class="n">nondim_x_stations</span> <span class="o">*</span> <span class="n">wing_chord_section_a</span>  <span class="c1">#x positions accounting for control surface cuts, relative to leading</span>
            <span class="n">x_stations_b</span>      <span class="o">=</span> <span class="n">nondim_x_stations</span> <span class="o">*</span> <span class="n">wing_chord_section_b</span>
            <span class="n">x_stations</span>        <span class="o">=</span> <span class="n">nondim_x_stations</span> <span class="o">*</span> <span class="n">wing_chord_section</span>
            
            <span class="n">delta_x_a</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_stations_a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_stations_a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">n_cw</span>  
            <span class="n">delta_x_b</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_stations_b</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_stations_b</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">n_cw</span>      
            <span class="n">delta_x</span>   <span class="o">=</span> <span class="p">(</span><span class="n">x_stations</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>   <span class="o">-</span> <span class="n">x_stations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="p">)</span><span class="o">/</span><span class="n">n_cw</span>             
    
            <span class="c1"># define coordinates of horseshoe vortices and control points------------------------------------------</span>
            <span class="n">xi_a1</span> <span class="o">=</span> <span class="n">break_x_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_sweep</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span> <span class="o">+</span> <span class="n">x_stations_a</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                  <span class="c1"># x coordinate of top left corner of panel</span>
            <span class="n">xi_ah</span> <span class="o">=</span> <span class="n">break_x_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_sweep</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span> <span class="o">+</span> <span class="n">x_stations_a</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_a</span><span class="o">*</span><span class="mf">0.25</span> <span class="c1"># x coordinate of left corner of panel</span>
            <span class="n">xi_ac</span> <span class="o">=</span> <span class="n">break_x_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_sweep</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span> <span class="o">+</span> <span class="n">x_stations_a</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_a</span><span class="o">*</span><span class="mf">0.75</span> <span class="c1"># x coordinate of bottom left corner of control point vortex  </span>
            <span class="n">xi_a2</span> <span class="o">=</span> <span class="n">break_x_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_sweep</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span> <span class="o">+</span> <span class="n">x_stations_a</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>                   <span class="c1"># x coordinate of bottom left corner of bound vortex </span>
            <span class="n">xi_b1</span> <span class="o">=</span> <span class="n">break_x_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_sweep</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span> <span class="o">+</span> <span class="n">x_stations_b</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                  <span class="c1"># x coordinate of top right corner of panel      </span>
            <span class="n">xi_bh</span> <span class="o">=</span> <span class="n">break_x_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_sweep</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span> <span class="o">+</span> <span class="n">x_stations_b</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_b</span><span class="o">*</span><span class="mf">0.25</span> <span class="c1"># x coordinate of right corner of bound vortex         </span>
            <span class="n">xi_bc</span> <span class="o">=</span> <span class="n">break_x_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_sweep</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span> <span class="o">+</span> <span class="n">x_stations_b</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_b</span><span class="o">*</span><span class="mf">0.75</span> <span class="c1"># x coordinate of bottom right corner of control point vortex         </span>
            <span class="n">xi_b2</span> <span class="o">=</span> <span class="n">break_x_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_sweep</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span> <span class="o">+</span> <span class="n">x_stations_b</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>                   <span class="c1"># x coordinate of bottom right corner of panel</span>
            <span class="n">xi_ch</span> <span class="o">=</span> <span class="n">break_x_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta</span>  <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_sweep</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span> <span class="o">+</span> <span class="n">x_stations</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>   <span class="o">+</span> <span class="n">delta_x</span>  <span class="o">*</span><span class="mf">0.25</span> <span class="c1"># x coordinate center of bound vortex of each panel </span>
            <span class="n">xi_c</span>  <span class="o">=</span> <span class="n">break_x_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta</span>  <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_sweep</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span> <span class="o">+</span> <span class="n">x_stations</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>   <span class="o">+</span> <span class="n">delta_x</span>  <span class="o">*</span><span class="mf">0.75</span> <span class="c1"># x coordinate three-quarter chord control point for each panel</span>
    
            <span class="c1">#adjust for camber-------------------------------------------------------------------------------------    </span>
            <span class="c1">#format camber vars for wings vs control surface wings</span>
            <span class="n">nondim_camber_x_coords</span> <span class="o">=</span> <span class="n">break_camber_xs</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">*</span><span class="mi">1</span>
            <span class="n">nondim_camber</span>          <span class="o">=</span> <span class="n">break_camber_zs</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">*</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">wing</span><span class="o">.</span><span class="n">is_a_control_surface</span><span class="p">:</span> <span class="c1">#rescale so that airfoils get cut properly</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">wing</span><span class="o">.</span><span class="n">is_slat</span><span class="p">:</span>
                    <span class="n">nondim_camber_x_coords</span> <span class="o">-=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">wing</span><span class="o">.</span><span class="n">chord_fraction</span>
                <span class="n">nondim_camber_x_coords</span> <span class="o">/=</span> <span class="n">wing</span><span class="o">.</span><span class="n">chord_fraction</span>
                <span class="n">nondim_camber</span>          <span class="o">/=</span> <span class="n">wing</span><span class="o">.</span><span class="n">chord_fraction</span>
    
            <span class="c1"># adjustment of coordinates for camber</span>
            <span class="n">section_camber_a</span>  <span class="o">=</span> <span class="n">nondim_camber</span><span class="o">*</span><span class="n">wing_chord_section_a</span>  
            <span class="n">section_camber_b</span>  <span class="o">=</span> <span class="n">nondim_camber</span><span class="o">*</span><span class="n">wing_chord_section_b</span>  
            <span class="n">section_camber_c</span>  <span class="o">=</span> <span class="n">nondim_camber</span><span class="o">*</span><span class="n">wing_chord_section</span>             
            
            <span class="n">section_x_coord_a</span> <span class="o">=</span> <span class="n">nondim_camber_x_coords</span><span class="o">*</span><span class="n">wing_chord_section_a</span>
            <span class="n">section_x_coord_b</span> <span class="o">=</span> <span class="n">nondim_camber_x_coords</span><span class="o">*</span><span class="n">wing_chord_section_b</span>
            <span class="n">section_x_coord</span>   <span class="o">=</span> <span class="n">nondim_camber_x_coords</span><span class="o">*</span><span class="n">wing_chord_section</span>
    
            <span class="n">z_c_a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">((</span><span class="n">x_stations_a</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                 <span class="p">)</span> <span class="p">,</span><span class="n">section_x_coord_a</span><span class="p">,</span> <span class="n">section_camber_a</span><span class="p">)</span> 
            <span class="n">z_c_ah</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">((</span><span class="n">x_stations_a</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_a</span><span class="o">*</span><span class="mf">0.25</span><span class="p">)</span> <span class="p">,</span><span class="n">section_x_coord_a</span><span class="p">,</span> <span class="n">section_camber_a</span><span class="p">)</span>
            <span class="n">z_c_ac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">((</span><span class="n">x_stations_a</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_a</span><span class="o">*</span><span class="mf">0.75</span><span class="p">)</span> <span class="p">,</span><span class="n">section_x_coord_a</span><span class="p">,</span> <span class="n">section_camber_a</span><span class="p">)</span> 
            <span class="n">z_c_a2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">((</span><span class="n">x_stations_a</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>                  <span class="p">)</span> <span class="p">,</span><span class="n">section_x_coord_a</span><span class="p">,</span> <span class="n">section_camber_a</span><span class="p">)</span> 
            <span class="n">z_c_b1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">((</span><span class="n">x_stations_b</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                 <span class="p">)</span> <span class="p">,</span><span class="n">section_x_coord_b</span><span class="p">,</span> <span class="n">section_camber_b</span><span class="p">)</span>   
            <span class="n">z_c_bh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">((</span><span class="n">x_stations_b</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_b</span><span class="o">*</span><span class="mf">0.25</span><span class="p">)</span> <span class="p">,</span><span class="n">section_x_coord_b</span><span class="p">,</span> <span class="n">section_camber_b</span><span class="p">)</span> 
            <span class="n">z_c_bc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">((</span><span class="n">x_stations_b</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_b</span><span class="o">*</span><span class="mf">0.75</span><span class="p">)</span> <span class="p">,</span><span class="n">section_x_coord_b</span><span class="p">,</span> <span class="n">section_camber_b</span><span class="p">)</span> 
            <span class="n">z_c_b2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">((</span><span class="n">x_stations_b</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>                  <span class="p">)</span> <span class="p">,</span><span class="n">section_x_coord_b</span><span class="p">,</span> <span class="n">section_camber_b</span><span class="p">)</span> 
            <span class="n">z_c_ch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">((</span><span class="n">x_stations</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>   <span class="o">+</span> <span class="n">delta_x</span>  <span class="o">*</span><span class="mf">0.25</span><span class="p">)</span> <span class="p">,</span><span class="n">section_x_coord</span>  <span class="p">,</span> <span class="n">section_camber_c</span><span class="p">)</span> 
            <span class="n">z_c</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">((</span><span class="n">x_stations</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>   <span class="o">+</span> <span class="n">delta_x</span>  <span class="o">*</span><span class="mf">0.75</span><span class="p">)</span> <span class="p">,</span><span class="n">section_x_coord</span>  <span class="p">,</span> <span class="n">section_camber_c</span><span class="p">)</span> 
    
            <span class="c1"># adjust for dihedral and add to camber----------------------------------------------------------------    </span>
            <span class="n">zeta_a1</span> <span class="o">=</span> <span class="n">break_z_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_dihedral</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span>  <span class="o">+</span> <span class="n">z_c_a1</span>  <span class="c1"># z coordinate of top left corner of panel</span>
            <span class="n">zeta_ah</span> <span class="o">=</span> <span class="n">break_z_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_dihedral</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span>  <span class="o">+</span> <span class="n">z_c_ah</span>  <span class="c1"># z coordinate of left corner of bound vortex  </span>
            <span class="n">zeta_a2</span> <span class="o">=</span> <span class="n">break_z_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_dihedral</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span>  <span class="o">+</span> <span class="n">z_c_a2</span>  <span class="c1"># z coordinate of bottom left corner of panel</span>
            <span class="n">zeta_ac</span> <span class="o">=</span> <span class="n">break_z_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_dihedral</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span>  <span class="o">+</span> <span class="n">z_c_ac</span>  <span class="c1"># z coordinate of bottom left corner of panel of control point</span>
            <span class="n">zeta_bc</span> <span class="o">=</span> <span class="n">break_z_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_dihedral</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span>  <span class="o">+</span> <span class="n">z_c_bc</span>  <span class="c1"># z coordinate of top right corner of panel of control point                          </span>
            <span class="n">zeta_b1</span> <span class="o">=</span> <span class="n">break_z_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_dihedral</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span>  <span class="o">+</span> <span class="n">z_c_b1</span>  <span class="c1"># z coordinate of top right corner of panel  </span>
            <span class="n">zeta_bh</span> <span class="o">=</span> <span class="n">break_z_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_dihedral</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span>  <span class="o">+</span> <span class="n">z_c_bh</span>  <span class="c1"># z coordinate of right corner of bound vortex        </span>
            <span class="n">zeta_b2</span> <span class="o">=</span> <span class="n">break_z_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_dihedral</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span>  <span class="o">+</span> <span class="n">z_c_b2</span>  <span class="c1"># z coordinate of bottom right corner of panel                 </span>
            <span class="n">zeta_ch</span> <span class="o">=</span> <span class="n">break_z_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta</span>  <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_dihedral</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span>  <span class="o">+</span> <span class="n">z_c_ch</span>  <span class="c1"># z coordinate center of bound vortex on each panel</span>
            <span class="n">zeta</span>    <span class="o">=</span> <span class="n">break_z_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta</span>  <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_dihedral</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span>  <span class="o">+</span> <span class="n">z_c</span>     <span class="c1"># z coordinate three-quarter chord control point for each panel</span>
    
            <span class="c1"># adjust for twist-------------------------------------------------------------------------------------</span>
            <span class="c1"># pivot point is the leading edge before camber  </span>
            <span class="n">pivot_x_a</span> <span class="o">=</span> <span class="n">break_x_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_sweep</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span>             <span class="c1"># x location of leading edge left corner of wing</span>
            <span class="n">pivot_x_b</span> <span class="o">=</span> <span class="n">break_x_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_sweep</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span>             <span class="c1"># x location of leading edge right of wing</span>
            <span class="n">pivot_x</span>   <span class="o">=</span> <span class="n">break_x_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta</span>  <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_sweep</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span>             <span class="c1"># x location of leading edge center of wing</span>
            
            <span class="n">pivot_z_a</span> <span class="o">=</span> <span class="n">break_z_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_dihedral</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span>          <span class="c1"># z location of leading edge left corner of wing</span>
            <span class="n">pivot_z_b</span> <span class="o">=</span> <span class="n">break_z_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta_b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_dihedral</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span>          <span class="c1"># z location of leading edge right of wing</span>
            <span class="n">pivot_z</span>   <span class="o">=</span> <span class="n">break_z_offset</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="n">eta</span>  <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">break_dihedral</span><span class="p">[</span><span class="n">i_break</span><span class="p">])</span>          <span class="c1"># z location of leading edge center of wing</span>
    
            <span class="c1"># adjust twist pivot line for control surface wings: offset leading edge to match that of the owning wing            </span>
            <span class="k">if</span> <span class="n">wing</span><span class="o">.</span><span class="n">is_a_control_surface</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">wing</span><span class="o">.</span><span class="n">is_slat</span><span class="p">:</span> <span class="c1">#correction only leading for non-leading edge control surfaces since the LE is the pivot by default</span>
                <span class="n">nondim_cs_LE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">wing</span><span class="o">.</span><span class="n">chord_fraction</span><span class="p">)</span>
                <span class="n">pivot_x_a</span>   <span class="o">-=</span> <span class="n">nondim_cs_LE</span> <span class="o">*</span><span class="p">(</span><span class="n">wing_chord_section_a</span> <span class="o">/</span><span class="n">wing</span><span class="o">.</span><span class="n">chord_fraction</span><span class="p">)</span> 
                <span class="n">pivot_x_b</span>   <span class="o">-=</span> <span class="n">nondim_cs_LE</span> <span class="o">*</span><span class="p">(</span><span class="n">wing_chord_section_b</span> <span class="o">/</span><span class="n">wing</span><span class="o">.</span><span class="n">chord_fraction</span><span class="p">)</span> 
                <span class="n">pivot_x</span>     <span class="o">-=</span> <span class="n">nondim_cs_LE</span> <span class="o">*</span><span class="p">(</span><span class="n">wing_chord_section</span>   <span class="o">/</span><span class="n">wing</span><span class="o">.</span><span class="n">chord_fraction</span><span class="p">)</span> 
    
            <span class="c1"># adjust coordinates for twist</span>
            <span class="n">section_twist_a</span> <span class="o">=</span> <span class="n">break_twist</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">eta_a</span> <span class="o">*</span> <span class="n">segment_twist_ratio</span><span class="p">)</span>               <span class="c1"># twist at left side of panel</span>
            <span class="n">section_twist_b</span> <span class="o">=</span> <span class="n">break_twist</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">eta_b</span> <span class="o">*</span> <span class="n">segment_twist_ratio</span><span class="p">)</span>               <span class="c1"># twist at right side of panel</span>
            <span class="n">section_twist</span>   <span class="o">=</span> <span class="n">break_twist</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">eta</span>   <span class="o">*</span> <span class="n">segment_twist_ratio</span><span class="p">)</span>               <span class="c1"># twist at center local chord </span>
    
            <span class="n">xi_prime_a1</span>    <span class="o">=</span> <span class="n">pivot_x_a</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">section_twist_a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xi_a1</span><span class="o">-</span><span class="n">pivot_x_a</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist_a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zeta_a1</span><span class="o">-</span><span class="n">pivot_z_a</span><span class="p">)</span> <span class="c1"># x coordinate transformation of top left corner</span>
            <span class="n">xi_prime_ah</span>    <span class="o">=</span> <span class="n">pivot_x_a</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">section_twist_a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xi_ah</span><span class="o">-</span><span class="n">pivot_x_a</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist_a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zeta_ah</span><span class="o">-</span><span class="n">pivot_z_a</span><span class="p">)</span> <span class="c1"># x coordinate transformation of bottom left corner</span>
            <span class="n">xi_prime_ac</span>    <span class="o">=</span> <span class="n">pivot_x_a</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">section_twist_a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xi_ac</span><span class="o">-</span><span class="n">pivot_x_a</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist_a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zeta_a2</span><span class="o">-</span><span class="n">pivot_z_a</span><span class="p">)</span> <span class="c1"># x coordinate transformation of bottom left corner of control point</span>
            <span class="n">xi_prime_a2</span>    <span class="o">=</span> <span class="n">pivot_x_a</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">section_twist_a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xi_a2</span><span class="o">-</span><span class="n">pivot_x_a</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist_a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zeta_a2</span><span class="o">-</span><span class="n">pivot_z_a</span><span class="p">)</span> <span class="c1"># x coordinate transformation of bottom left corner</span>
            <span class="n">xi_prime_b1</span>    <span class="o">=</span> <span class="n">pivot_x_b</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">section_twist_b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xi_b1</span><span class="o">-</span><span class="n">pivot_x_b</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist_b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zeta_b1</span><span class="o">-</span><span class="n">pivot_z_b</span><span class="p">)</span> <span class="c1"># x coordinate transformation of top right corner </span>
            <span class="n">xi_prime_bh</span>    <span class="o">=</span> <span class="n">pivot_x_b</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">section_twist_b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xi_bh</span><span class="o">-</span><span class="n">pivot_x_b</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist_b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zeta_bh</span><span class="o">-</span><span class="n">pivot_z_b</span><span class="p">)</span> <span class="c1"># x coordinate transformation of top right corner </span>
            <span class="n">xi_prime_bc</span>    <span class="o">=</span> <span class="n">pivot_x_b</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">section_twist_b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xi_bc</span><span class="o">-</span><span class="n">pivot_x_b</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist_b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zeta_b1</span><span class="o">-</span><span class="n">pivot_z_b</span><span class="p">)</span> <span class="c1"># x coordinate transformation of top right corner of control point                         </span>
            <span class="n">xi_prime_b2</span>    <span class="o">=</span> <span class="n">pivot_x_b</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">section_twist_b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xi_b2</span><span class="o">-</span><span class="n">pivot_x_b</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist_b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zeta_b2</span><span class="o">-</span><span class="n">pivot_z_b</span><span class="p">)</span> <span class="c1"># x coordinate transformation of botton right corner </span>
            <span class="n">xi_prime_ch</span>    <span class="o">=</span> <span class="n">pivot_x</span>   <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">section_twist</span><span class="p">)</span>  <span class="o">*</span><span class="p">(</span><span class="n">xi_ch</span><span class="o">-</span><span class="n">pivot_x</span><span class="p">)</span>   <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist</span><span class="p">)</span>  <span class="o">*</span><span class="p">(</span><span class="n">zeta_ch</span><span class="o">-</span><span class="n">pivot_z</span><span class="p">)</span>   <span class="c1"># x coordinate transformation of center of horeshoe vortex </span>
            <span class="n">xi_prime</span>       <span class="o">=</span> <span class="n">pivot_x</span>   <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">section_twist</span><span class="p">)</span>  <span class="o">*</span><span class="p">(</span><span class="n">xi_c</span> <span class="o">-</span><span class="n">pivot_x</span><span class="p">)</span>   <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist</span><span class="p">)</span>  <span class="o">*</span><span class="p">(</span><span class="n">zeta</span>   <span class="o">-</span><span class="n">pivot_z</span><span class="p">)</span>   <span class="c1"># x coordinate transformation of control point</span>
    
            <span class="n">zeta_prime_a1</span>  <span class="o">=</span> <span class="n">pivot_z_a</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist_a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xi_a1</span><span class="o">-</span><span class="n">pivot_x_a</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">section_twist_a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zeta_a1</span><span class="o">-</span><span class="n">pivot_z_a</span><span class="p">)</span> <span class="c1"># z coordinate transformation of top left corner</span>
            <span class="n">zeta_prime_ah</span>  <span class="o">=</span> <span class="n">pivot_z_a</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist_a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xi_ah</span><span class="o">-</span><span class="n">pivot_x_a</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">section_twist_a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zeta_ah</span><span class="o">-</span><span class="n">pivot_z_a</span><span class="p">)</span> <span class="c1"># z coordinate transformation of bottom left corner</span>
            <span class="n">zeta_prime_ac</span>  <span class="o">=</span> <span class="n">pivot_z_a</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist_a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xi_ac</span><span class="o">-</span><span class="n">pivot_x_a</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">section_twist_a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zeta_ac</span><span class="o">-</span><span class="n">pivot_z_a</span><span class="p">)</span> <span class="c1"># z coordinate transformation of bottom left corner</span>
            <span class="n">zeta_prime_a2</span>  <span class="o">=</span> <span class="n">pivot_z_a</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist_a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xi_a2</span><span class="o">-</span><span class="n">pivot_x_a</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">section_twist_a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zeta_a2</span><span class="o">-</span><span class="n">pivot_z_a</span><span class="p">)</span> <span class="c1"># z coordinate transformation of bottom left corner</span>
            <span class="n">zeta_prime_b1</span>  <span class="o">=</span> <span class="n">pivot_z_b</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist_b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xi_b1</span><span class="o">-</span><span class="n">pivot_x_b</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">section_twist_b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zeta_b1</span><span class="o">-</span><span class="n">pivot_z_b</span><span class="p">)</span> <span class="c1"># z coordinate transformation of top right corner </span>
            <span class="n">zeta_prime_bh</span>  <span class="o">=</span> <span class="n">pivot_z_b</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist_b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xi_bh</span><span class="o">-</span><span class="n">pivot_x_b</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">section_twist_b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zeta_bh</span><span class="o">-</span><span class="n">pivot_z_b</span><span class="p">)</span> <span class="c1"># z coordinate transformation of top right corner </span>
            <span class="n">zeta_prime_bc</span>  <span class="o">=</span> <span class="n">pivot_z_b</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist_b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xi_bc</span><span class="o">-</span><span class="n">pivot_x_b</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">section_twist_b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zeta_bc</span><span class="o">-</span><span class="n">pivot_z_b</span><span class="p">)</span> <span class="c1"># z coordinate transformation of top right corner                         </span>
            <span class="n">zeta_prime_b2</span>  <span class="o">=</span> <span class="n">pivot_z_b</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist_b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">xi_b2</span><span class="o">-</span><span class="n">pivot_x_b</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">section_twist_b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">zeta_b2</span><span class="o">-</span><span class="n">pivot_z_b</span><span class="p">)</span> <span class="c1"># z coordinate transformation of botton right corner </span>
            <span class="n">zeta_prime_ch</span>  <span class="o">=</span> <span class="n">pivot_z</span>   <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist</span><span class="p">)</span>  <span class="o">*</span><span class="p">(</span><span class="n">xi_ch</span><span class="o">-</span><span class="n">pivot_x</span><span class="p">)</span>   <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">section_twist</span><span class="p">)</span> <span class="o">*</span><span class="p">(</span><span class="n">zeta_ch</span><span class="o">-</span><span class="n">pivot_z</span><span class="p">)</span>   <span class="c1"># z coordinate transformation of center of horseshoe</span>
            <span class="n">zeta_prime</span>     <span class="o">=</span> <span class="n">pivot_z</span>   <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">section_twist</span><span class="p">)</span>  <span class="o">*</span><span class="p">(</span><span class="n">xi_c</span> <span class="o">-</span><span class="n">pivot_x</span><span class="p">)</span>   <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="n">section_twist</span><span class="p">)</span> <span class="o">*</span><span class="p">(</span><span class="n">zeta</span>   <span class="o">-</span><span class="n">pivot_z</span><span class="p">)</span>   <span class="c1"># z coordinate transformation of control point</span>
            
            <span class="c1"># Define y-coordinate and other arrays-----------------------------------------------------------------</span>
            <span class="c1"># take normal value for first wing, then reflect over xz plane for a symmetric wing</span>
            <span class="n">y_prime_as</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">y_a</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span>                 <span class="p">)</span> <span class="o">*</span><span class="n">sym_sign</span>          
            <span class="n">y_prime_a1</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_prime_as</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                            <span class="p">)</span> <span class="o">*</span><span class="mi">1</span>       
            <span class="n">y_prime_ah</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_prime_as</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                            <span class="p">)</span> <span class="o">*</span><span class="mi">1</span>       
            <span class="n">y_prime_ac</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_prime_as</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                            <span class="p">)</span> <span class="o">*</span><span class="mi">1</span>          
            <span class="n">y_prime_a2</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_prime_as</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                            <span class="p">)</span> <span class="o">*</span><span class="mi">1</span>        
            <span class="n">y_prime_bs</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">y_b</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span>                 <span class="p">)</span> <span class="o">*</span><span class="n">sym_sign</span>            
            <span class="n">y_prime_b1</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_prime_bs</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                            <span class="p">)</span> <span class="o">*</span><span class="mi">1</span>         
            <span class="n">y_prime_bh</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_prime_bs</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                            <span class="p">)</span> <span class="o">*</span><span class="mi">1</span>         
            <span class="n">y_prime_bc</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_prime_bs</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                            <span class="p">)</span> <span class="o">*</span><span class="mi">1</span>         
            <span class="n">y_prime_b2</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_prime_bs</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                            <span class="p">)</span> <span class="o">*</span><span class="mi">1</span>   
            <span class="n">y_prime_ch</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y_b</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span> <span class="o">-</span> <span class="n">del_y</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span><span class="n">sym_sign</span>
            <span class="n">y_prime</span>    <span class="o">=</span> <span class="p">(</span><span class="n">y_prime_ch</span>                                 <span class="p">)</span> <span class="o">*</span><span class="mi">1</span>    
            
            <span class="c1"># populate all corners of all panels. Right side only populated for last strip wing the wing</span>
            <span class="n">xi_prime_as</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">xi_prime_a1</span><span class="p">,</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xi_prime_a2</span>  <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])])</span><span class="o">*</span><span class="mi">1</span>
            <span class="n">xi_prime_bs</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">xi_prime_b1</span><span class="p">,</span>  <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xi_prime_b2</span>  <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])])</span><span class="o">*</span><span class="mi">1</span>
            <span class="n">zeta_prime_as</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">zeta_prime_a1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">zeta_prime_a2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])])</span><span class="o">*</span><span class="mi">1</span>            
            <span class="n">zeta_prime_bs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">zeta_prime_b1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">zeta_prime_b2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])])</span><span class="o">*</span><span class="mi">1</span>  
            
            <span class="c1"># reflect over the plane y = z for a vertical wing-----------------------------------------------------</span>
            <span class="k">if</span> <span class="n">vertical_wing</span><span class="p">:</span>
                <span class="n">y_prime_a1</span><span class="p">,</span> <span class="n">zeta_prime_a1</span> <span class="o">=</span> <span class="n">zeta_prime_a1</span><span class="p">,</span> <span class="n">wing</span><span class="o">.</span><span class="n">inverted_wing</span><span class="o">*</span><span class="n">y_prime_a1</span>
                <span class="n">y_prime_ah</span><span class="p">,</span> <span class="n">zeta_prime_ah</span> <span class="o">=</span> <span class="n">zeta_prime_ah</span><span class="p">,</span> <span class="n">wing</span><span class="o">.</span><span class="n">inverted_wing</span><span class="o">*</span><span class="n">y_prime_ah</span>
                <span class="n">y_prime_ac</span><span class="p">,</span> <span class="n">zeta_prime_ac</span> <span class="o">=</span> <span class="n">zeta_prime_ac</span><span class="p">,</span> <span class="n">wing</span><span class="o">.</span><span class="n">inverted_wing</span><span class="o">*</span><span class="n">y_prime_ac</span>
                <span class="n">y_prime_a2</span><span class="p">,</span> <span class="n">zeta_prime_a2</span> <span class="o">=</span> <span class="n">zeta_prime_a2</span><span class="p">,</span> <span class="n">wing</span><span class="o">.</span><span class="n">inverted_wing</span><span class="o">*</span><span class="n">y_prime_a2</span>
                                                                     
                <span class="n">y_prime_b1</span><span class="p">,</span> <span class="n">zeta_prime_b1</span> <span class="o">=</span> <span class="n">zeta_prime_b1</span><span class="p">,</span> <span class="n">wing</span><span class="o">.</span><span class="n">inverted_wing</span><span class="o">*</span><span class="n">y_prime_b1</span>
                <span class="n">y_prime_bh</span><span class="p">,</span> <span class="n">zeta_prime_bh</span> <span class="o">=</span> <span class="n">zeta_prime_bh</span><span class="p">,</span> <span class="n">wing</span><span class="o">.</span><span class="n">inverted_wing</span><span class="o">*</span><span class="n">y_prime_bh</span>
                <span class="n">y_prime_bc</span><span class="p">,</span> <span class="n">zeta_prime_bc</span> <span class="o">=</span> <span class="n">zeta_prime_bc</span><span class="p">,</span> <span class="n">wing</span><span class="o">.</span><span class="n">inverted_wing</span><span class="o">*</span><span class="n">y_prime_bc</span>
                <span class="n">y_prime_b2</span><span class="p">,</span> <span class="n">zeta_prime_b2</span> <span class="o">=</span> <span class="n">zeta_prime_b2</span><span class="p">,</span> <span class="n">wing</span><span class="o">.</span><span class="n">inverted_wing</span><span class="o">*</span><span class="n">y_prime_b2</span>
                
                <span class="n">y_prime_ch</span><span class="p">,</span> <span class="n">zeta_prime_ch</span> <span class="o">=</span> <span class="n">zeta_prime_ch</span><span class="p">,</span> <span class="n">wing</span><span class="o">.</span><span class="n">inverted_wing</span><span class="o">*</span><span class="n">y_prime_ch</span>
                <span class="n">y_prime</span>   <span class="p">,</span> <span class="n">zeta_prime</span>    <span class="o">=</span> <span class="n">zeta_prime</span>   <span class="p">,</span> <span class="n">wing</span><span class="o">.</span><span class="n">inverted_wing</span><span class="o">*</span><span class="n">y_prime</span>
                
                <span class="n">y_prime_as</span><span class="p">,</span> <span class="n">zeta_prime_as</span> <span class="o">=</span> <span class="n">zeta_prime_as</span><span class="p">,</span> <span class="n">wing</span><span class="o">.</span><span class="n">inverted_wing</span><span class="o">*</span><span class="n">y_prime_as</span>

 
                <span class="n">y_prime_bs</span> <span class="o">=</span> <span class="n">wing</span><span class="o">.</span><span class="n">inverted_wing</span><span class="o">*</span><span class="n">y_prime_bs</span>
                <span class="n">y_prime_bs</span><span class="p">,</span> <span class="n">zeta_prime_bs</span> <span class="o">=</span> <span class="n">zeta_prime_bs</span><span class="p">,</span> <span class="n">y_prime_bs</span>
                 
            <span class="c1"># store coordinates of panels, horseshoeces vortices and control points relative to wing root----------</span>
            <span class="n">xa1</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">xi_prime_a1</span>     <span class="c1"># top left corner of panel</span>
            <span class="n">ya1</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_prime_a1</span>
            <span class="n">za1</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">zeta_prime_a1</span>
            <span class="n">xah</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">xi_prime_ah</span>     <span class="c1"># left coord of horseshoe</span>
            <span class="n">yah</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_prime_ah</span>
            <span class="n">zah</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">zeta_prime_ah</span>                    
            <span class="n">xac</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">xi_prime_ac</span>     <span class="c1"># left coord of control point</span>
            <span class="n">yac</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_prime_ac</span>
            <span class="n">zac</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">zeta_prime_ac</span>
            <span class="n">xa2</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">xi_prime_a2</span>     <span class="c1"># bottom left corner of panel</span>
            <span class="n">ya2</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_prime_a2</span>
            <span class="n">za2</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">zeta_prime_a2</span>
                                             
            <span class="n">xb1</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">xi_prime_b1</span>     <span class="c1"># top right corner of panel</span>
            <span class="n">yb1</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_prime_b1</span>          
            <span class="n">zb1</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">zeta_prime_b1</span>   
            <span class="n">xbh</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">xi_prime_bh</span>     <span class="c1"># right coord of horseshoe</span>
            <span class="n">ybh</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_prime_bh</span>          
            <span class="n">zbh</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">zeta_prime_bh</span>                    
            <span class="n">xbc</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">xi_prime_bc</span>     <span class="c1"># right coord of control point</span>
            <span class="n">ybc</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_prime_bc</span>                           
            <span class="n">zbc</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">zeta_prime_bc</span>   
            <span class="n">xb2</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">xi_prime_b2</span>     <span class="c1"># bottom right corner of panel</span>
            <span class="n">yb2</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_prime_b2</span>                        
            <span class="n">zb2</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">zeta_prime_b2</span> 
                                             
            <span class="n">xch</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">xi_prime_ch</span>     <span class="c1"># center coord of horseshoe</span>
            <span class="n">ych</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_prime_ch</span>                              
            <span class="n">zch</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">zeta_prime_ch</span>
            <span class="n">xc</span> <span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">xi_prime</span>        <span class="c1"># center (true) coord of control point</span>
            <span class="n">yc</span> <span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_prime</span>
            <span class="n">zc</span> <span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">zeta_prime</span> 
           
            <span class="n">x</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">):(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">xi_prime_as</span>     <span class="c1"># x, y, z represent all all points of the corners of the panels, LE and TE inclusive</span>
            <span class="n">y</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">):(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">y_prime_as</span>      <span class="c1"># the final right corners get appended at last strip in wing, later</span>
            <span class="n">z</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">):(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">zeta_prime_as</span>              

            <span class="n">cs_w</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span> <span class="o">=</span> <span class="n">wing_chord_section</span>       
                   
            <span class="c1"># store this strip&#39;s discretization information--------------------------------------------------------</span>
            <span class="n">LE_inds</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">n_cw</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">TE_inds</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">n_cw</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">LE_inds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>     <span class="o">=</span> <span class="kc">True</span>
            <span class="n">TE_inds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>    <span class="o">=</span> <span class="kc">True</span>
            
            <span class="n">RNMAX</span>          <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span>
            <span class="n">panel_numbers</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n_cw</span><span class="p">,</span><span class="n">n_cw</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>           
                        
            <span class="n">is_a_slat</span>                  <span class="o">=</span> <span class="n">wing</span><span class="o">.</span><span class="n">is_a_control_surface</span> <span class="ow">and</span> <span class="n">wing</span><span class="o">.</span><span class="n">is_slat</span>
            <span class="n">strip_has_no_slat</span>          <span class="o">=</span> <span class="p">(</span><span class="ow">not</span> <span class="n">wing</span><span class="o">.</span><span class="n">is_a_control_surface</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">span_breaks</span><span class="p">[</span><span class="n">i_break</span><span class="p">]</span><span class="o">.</span><span class="n">cs_IDs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># wing&#39;s le, outboard control surface ID</span>
            <span class="n">exposed_leading_edge_flag</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_a_slat</span> <span class="ow">or</span> <span class="n">strip_has_no_slat</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>   
            
            <span class="n">VD</span><span class="o">.</span><span class="n">leading_edge_indices</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">leading_edge_indices</span>     <span class="p">,</span> <span class="n">LE_inds</span>                  <span class="p">)</span> 
            <span class="n">VD</span><span class="o">.</span><span class="n">trailing_edge_indices</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">trailing_edge_indices</span>    <span class="p">,</span> <span class="n">TE_inds</span>                  <span class="p">)</span>            
            <span class="n">VD</span><span class="o">.</span><span class="n">panels_per_strip</span>          <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">panels_per_strip</span>         <span class="p">,</span> <span class="n">RNMAX</span>                    <span class="p">)</span>
            <span class="n">VD</span><span class="o">.</span><span class="n">chordwise_panel_number</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">chordwise_panel_number</span>   <span class="p">,</span> <span class="n">panel_numbers</span>            <span class="p">)</span>  
            <span class="n">VD</span><span class="o">.</span><span class="n">exposed_leading_edge_flag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">exposed_leading_edge_flag</span><span class="p">,</span> <span class="n">exposed_leading_edge_flag</span><span class="p">)</span>
            
            <span class="c1">#increment i_break if needed; check for end of wing----------------------------------------------------</span>
            <span class="k">if</span> <span class="n">y_b</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span> <span class="o">==</span> <span class="n">break_spans</span><span class="p">[</span><span class="n">i_break</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span> 
                <span class="n">i_break</span> <span class="o">+=</span> <span class="mi">1</span>            
        <span class="c1">#End &#39;for each strip&#39; loop    </span>
        
        <span class="c1"># store outboardmost edge</span>
        <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span> <span class="o">=</span> <span class="n">xi_prime_bs</span>
        <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span> <span class="o">=</span> <span class="n">y_prime_bs</span>
        <span class="n">z</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span> <span class="o">=</span> <span class="n">zeta_prime_bs</span>              
        
        <span class="c1"># adjusting coordinate axis so reference point is at the nose of the aircraft------------------------------</span>
        <span class="n">xah</span> <span class="o">=</span> <span class="n">xah</span> <span class="o">+</span> <span class="n">wing_origin_x</span> <span class="c1"># x coordinate of left corner of bound vortex </span>
        <span class="n">yah</span> <span class="o">=</span> <span class="n">yah</span> <span class="o">+</span> <span class="n">wing_origin_y</span> <span class="c1"># y coordinate of left corner of bound vortex </span>
        <span class="n">zah</span> <span class="o">=</span> <span class="n">zah</span> <span class="o">+</span> <span class="n">wing_origin_z</span> <span class="c1"># z coordinate of left corner of bound vortex </span>
        <span class="n">xbh</span> <span class="o">=</span> <span class="n">xbh</span> <span class="o">+</span> <span class="n">wing_origin_x</span> <span class="c1"># x coordinate of right corner of bound vortex </span>
        <span class="n">ybh</span> <span class="o">=</span> <span class="n">ybh</span> <span class="o">+</span> <span class="n">wing_origin_y</span> <span class="c1"># y coordinate of right corner of bound vortex </span>
        <span class="n">zbh</span> <span class="o">=</span> <span class="n">zbh</span> <span class="o">+</span> <span class="n">wing_origin_z</span> <span class="c1"># z coordinate of right corner of bound vortex </span>
        <span class="n">xch</span> <span class="o">=</span> <span class="n">xch</span> <span class="o">+</span> <span class="n">wing_origin_x</span> <span class="c1"># x coordinate of center of bound vortex on panel</span>
        <span class="n">ych</span> <span class="o">=</span> <span class="n">ych</span> <span class="o">+</span> <span class="n">wing_origin_y</span> <span class="c1"># y coordinate of center of bound vortex on panel</span>
        <span class="n">zch</span> <span class="o">=</span> <span class="n">zch</span> <span class="o">+</span> <span class="n">wing_origin_z</span> <span class="c1"># z coordinate of center of bound vortex on panel  </span>
    
        <span class="n">xa1</span> <span class="o">=</span> <span class="n">xa1</span> <span class="o">+</span> <span class="n">wing_origin_x</span> <span class="c1"># x coordinate of top left corner of panel</span>
        <span class="n">ya1</span> <span class="o">=</span> <span class="n">ya1</span> <span class="o">+</span> <span class="n">wing_origin_y</span> <span class="c1"># y coordinate of bottom left corner of panel</span>
        <span class="n">za1</span> <span class="o">=</span> <span class="n">za1</span> <span class="o">+</span> <span class="n">wing_origin_z</span> <span class="c1"># z coordinate of top left corner of panel</span>
        <span class="n">xa2</span> <span class="o">=</span> <span class="n">xa2</span> <span class="o">+</span> <span class="n">wing_origin_x</span> <span class="c1"># x coordinate of bottom left corner of panel</span>
        <span class="n">ya2</span> <span class="o">=</span> <span class="n">ya2</span> <span class="o">+</span> <span class="n">wing_origin_y</span> <span class="c1"># x coordinate of bottom left corner of panel</span>
        <span class="n">za2</span> <span class="o">=</span> <span class="n">za2</span> <span class="o">+</span> <span class="n">wing_origin_z</span> <span class="c1"># z coordinate of bottom left corner of panel  </span>
    
        <span class="n">xb1</span> <span class="o">=</span> <span class="n">xb1</span> <span class="o">+</span> <span class="n">wing_origin_x</span> <span class="c1"># x coordinate of top right corner of panel  </span>
        <span class="n">yb1</span> <span class="o">=</span> <span class="n">yb1</span> <span class="o">+</span> <span class="n">wing_origin_y</span> <span class="c1"># y coordinate of top right corner of panel </span>
        <span class="n">zb1</span> <span class="o">=</span> <span class="n">zb1</span> <span class="o">+</span> <span class="n">wing_origin_z</span> <span class="c1"># z coordinate of top right corner of panel </span>
        <span class="n">xb2</span> <span class="o">=</span> <span class="n">xb2</span> <span class="o">+</span> <span class="n">wing_origin_x</span> <span class="c1"># x coordinate of bottom rightcorner of panel </span>
        <span class="n">yb2</span> <span class="o">=</span> <span class="n">yb2</span> <span class="o">+</span> <span class="n">wing_origin_y</span> <span class="c1"># y coordinate of bottom rightcorner of panel </span>
        <span class="n">zb2</span> <span class="o">=</span> <span class="n">zb2</span> <span class="o">+</span> <span class="n">wing_origin_z</span> <span class="c1"># z coordinate of bottom right corner of panel                   </span>
    
        <span class="n">xac</span> <span class="o">=</span> <span class="n">xac</span> <span class="o">+</span> <span class="n">wing_origin_x</span>  <span class="c1"># x coordinate of control points on panel</span>
        <span class="n">yac</span> <span class="o">=</span> <span class="n">yac</span> <span class="o">+</span> <span class="n">wing_origin_y</span>  <span class="c1"># y coordinate of control points on panel</span>
        <span class="n">zac</span> <span class="o">=</span> <span class="n">zac</span> <span class="o">+</span> <span class="n">wing_origin_z</span>  <span class="c1"># z coordinate of control points on panel</span>
        <span class="n">xbc</span> <span class="o">=</span> <span class="n">xbc</span> <span class="o">+</span> <span class="n">wing_origin_x</span>  <span class="c1"># x coordinate of control points on panel</span>
        <span class="n">ybc</span> <span class="o">=</span> <span class="n">ybc</span> <span class="o">+</span> <span class="n">wing_origin_y</span>  <span class="c1"># y coordinate of control points on panel</span>
        <span class="n">zbc</span> <span class="o">=</span> <span class="n">zbc</span> <span class="o">+</span> <span class="n">wing_origin_z</span>  <span class="c1"># z coordinate of control points on panel</span>
    
        <span class="n">xc</span>  <span class="o">=</span> <span class="n">xc</span>  <span class="o">+</span> <span class="n">wing_origin_x</span>  <span class="c1"># x coordinate of control points on panel</span>
        <span class="n">yc</span>  <span class="o">=</span> <span class="n">yc</span>  <span class="o">+</span> <span class="n">wing_origin_y</span>  <span class="c1"># y coordinate of control points on panel</span>
        <span class="n">zc</span>  <span class="o">=</span> <span class="n">zc</span>  <span class="o">+</span> <span class="n">wing_origin_z</span>  <span class="c1"># y coordinate of control points on panel</span>
        <span class="n">x</span>   <span class="o">=</span> <span class="n">x</span>   <span class="o">+</span> <span class="n">wing_origin_x</span>  <span class="c1"># x coordinate of control points on panel</span>
        <span class="n">y</span>   <span class="o">=</span> <span class="n">y</span>   <span class="o">+</span> <span class="n">wing_origin_y</span>  <span class="c1"># y coordinate of control points on panel</span>
        <span class="n">z</span>   <span class="o">=</span> <span class="n">z</span>   <span class="o">+</span> <span class="n">wing_origin_z</span>  <span class="c1"># y coordinate of control points on panel</span>
        
        <span class="c1"># VD discretization information----------------------------------------------------------------------------</span>
        
        <span class="c1"># increment number of wings and panels</span>
        <span class="n">n_panels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xch</span><span class="p">)</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">n_w</span>  <span class="o">+=</span> <span class="mi">1</span>             
        <span class="n">VD</span><span class="o">.</span><span class="n">n_cp</span> <span class="o">+=</span> <span class="n">n_panels</span> 
        
        <span class="c1"># store this wing&#39;s discretization information  </span>
        <span class="n">first_panel_ind</span>  <span class="o">=</span> <span class="n">VD</span><span class="o">.</span><span class="n">XAH</span><span class="o">.</span><span class="n">size</span>
        <span class="n">first_strip_ind</span>  <span class="o">=</span> <span class="n">VD</span><span class="o">.</span><span class="n">chordwise_breaks</span><span class="o">.</span><span class="n">size</span>
        <span class="n">chordwise_breaks</span> <span class="o">=</span> <span class="n">first_panel_ind</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_panels</span><span class="p">)[</span><span class="mi">0</span><span class="p">::</span><span class="n">n_cw</span><span class="p">]</span>
        <span class="n">ID</span>               <span class="o">=</span> <span class="n">VD</span><span class="o">.</span><span class="n">counter</span><span class="o">*</span><span class="mi">1</span>
        
        <span class="n">VD</span><span class="o">.</span><span class="n">chordwise_breaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">chordwise_breaks</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">chordwise_breaks</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">spanwise_breaks</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">spanwise_breaks</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">first_strip_ind</span> <span class="p">))</span>            
        <span class="n">VD</span><span class="o">.</span><span class="n">n_sw</span>             <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">n_sw</span>            <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">(</span><span class="n">n_sw</span><span class="p">)</span>            <span class="p">)</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">n_cw</span>             <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">n_cw</span>            <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span>            <span class="p">)</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">surface_ID</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">surface_ID</span>      <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span><span class="o">*</span><span class="n">ID</span><span class="o">*</span><span class="n">sym_sign</span><span class="p">)</span> <span class="c1"># Update me when the loop is gone</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">surface_ID_full</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">surface_ID_full</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">ID</span><span class="o">*</span><span class="n">sym_sign</span><span class="p">)</span> <span class="c1"># Update me when the loop is gone    </span>
                
        <span class="c1"># ---------------------------------------------------------------------------------------</span>
        <span class="c1"># STEP 7: Store wing in vehicle vector</span>
        <span class="c1"># --------------------------------------------------------------------------------------- </span>
        <span class="n">VD</span><span class="o">.</span><span class="n">XAH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XAH</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xah</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">YAH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YAH</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">yah</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">ZAH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZAH</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zah</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">XBH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XBH</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xbh</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">YBH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YBH</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ybh</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">ZBH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZBH</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zbh</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">XCH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XCH</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xch</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">YCH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YCH</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ych</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">ZCH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZCH</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zch</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>            
        <span class="n">VD</span><span class="o">.</span><span class="n">XA1</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XA1</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xa1</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">YA1</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YA1</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ya1</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">ZA1</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZA1</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">za1</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">XA2</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XA2</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xa2</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">YA2</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YA2</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ya2</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">ZA2</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZA2</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">za2</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>        
        <span class="n">VD</span><span class="o">.</span><span class="n">XB1</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XB1</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xb1</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">YB1</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YB1</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">yb1</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">ZB1</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZB1</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zb1</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">XB2</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XB2</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xb2</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>                
        <span class="n">VD</span><span class="o">.</span><span class="n">YB2</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YB2</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">yb2</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>        
        <span class="n">VD</span><span class="o">.</span><span class="n">ZB2</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZB2</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zb2</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span> 
        <span class="n">VD</span><span class="o">.</span><span class="n">XAC</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XAC</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xac</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">YAC</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YAC</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">yac</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span> 
        <span class="n">VD</span><span class="o">.</span><span class="n">ZAC</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZAC</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zac</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span> 
        <span class="n">VD</span><span class="o">.</span><span class="n">XBC</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XBC</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xbc</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">YBC</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YBC</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ybc</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span> 
        <span class="n">VD</span><span class="o">.</span><span class="n">ZBC</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZBC</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zbc</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>  
        <span class="n">VD</span><span class="o">.</span><span class="n">XC</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XC</span>   <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xc</span>   <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">YC</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YC</span>   <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">yc</span>   <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">ZC</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZC</span>   <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zc</span>   <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>  
        <span class="n">VD</span><span class="o">.</span><span class="n">X</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">X</span>    <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span>    <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">Y</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">Y</span>    <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span>    <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">Z</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">Z</span>    <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">z</span>    <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>         
        <span class="n">VD</span><span class="o">.</span><span class="n">CS</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">CS</span>   <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cs_w</span> <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span> 
        <span class="n">VD</span><span class="o">.</span><span class="n">DY</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">DY</span>   <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">del_y</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>    
    <span class="c1">#End symmetry loop</span>
    
    <span class="n">VD</span><span class="o">.</span><span class="n">symmetric_wings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">symmetric_wings</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">sym_para</span><span class="p">))</span>
    
    <span class="c1"># Pack wing data</span>
    <span class="n">wing</span><span class="o">.</span><span class="n">n_sw</span> <span class="o">=</span> <span class="n">n_sw</span>
    <span class="n">wing</span><span class="o">.</span><span class="n">n_cw</span> <span class="o">=</span> <span class="n">n_cw</span>    
    
    <span class="k">return</span> <span class="n">VD</span><span class="p">,</span> <span class="n">wing</span></div>

    

<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1">#  Discretize Fuselage</span>
<span class="c1"># ----------------------------------------------------------------------</span>
<span class="c1">## @ingroup Library-Methods-Aerodynamics-Common-Fidelity_Zero-Lift</span>
<div class="viewcode-block" id="generate_fuselage_and_nacelle_vortex_distribution">
<a class="viewcode-back" href="../../../../../../RCAIDE.Library.Methods.Aerodynamics.Vortex_Lattice_Method.html#RCAIDE.Library.Methods.Aerodynamics.Vortex_Lattice_Method.generate_vortex_distribution.generate_fuselage_and_nacelle_vortex_distribution">[docs]</a>
<span class="k">def</span> <span class="nf">generate_fuselage_and_nacelle_vortex_distribution</span><span class="p">(</span><span class="n">VD</span><span class="p">,</span><span class="n">fus</span><span class="p">,</span><span class="n">n_cw</span><span class="p">,</span><span class="n">n_sw</span><span class="p">,</span><span class="n">precision</span><span class="p">,</span><span class="n">model_geometry</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This generates the vortex distribution points on a fuselage or nacelle component</span>
<span class="sd">    Assumptions: </span>
<span class="sd">    If nacelle has segments defined, the mean width and height of the nacelle is used</span>
<span class="sd">    Source:   </span>
<span class="sd">    None</span>
<span class="sd">    </span>
<span class="sd">    Inputs:   </span>
<span class="sd">    VD                   - vortex distribution</span>
<span class="sd">    </span>
<span class="sd">    Properties Used:</span>
<span class="sd">    N/A</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    
    <span class="n">fhs_xa1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_ya1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_za1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_xa2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_ya2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_za2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_xb1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_yb1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_zb1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_yb2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_xb2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_zb2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_xah</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_yah</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_zah</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_xbh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_ybh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_zbh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_xch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_ych</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_zch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_xc</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_yc</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_zc</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_xac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_yac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_zac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_xbc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_ybc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_zbc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fhs_x</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">fhs_y</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">fhs_z</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>      

    <span class="n">fvs_xc</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fvs_zc</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>
    <span class="n">fvs_yc</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">*</span><span class="n">n_sw</span><span class="p">)</span>   
    <span class="n">fvs_x</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">fvs_y</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">fvs_z</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>   
    <span class="n">fus_v_cs</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_sw</span><span class="p">)</span>     
    
    <span class="c1"># arrays to hold strip discretization values</span>
    <span class="n">leading_edge_indices</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>    
    <span class="n">trailing_edge_indices</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>    
    <span class="n">panels_per_strip</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
    <span class="n">chordwise_panel_number</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>               

    <span class="c1"># geometry values</span>
    <span class="n">origin</span>     <span class="o">=</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># --TO DO-- model fuselage segments if defined, else use the following code</span>
    
    <span class="c1"># Horizontal Sections of fuselage</span>
    <span class="n">fhs</span>        <span class="o">=</span> <span class="n">Data</span><span class="p">()</span>        
    <span class="n">fhs</span><span class="o">.</span><span class="n">origin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>        
    <span class="n">fhs</span><span class="o">.</span><span class="n">chord</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>         
    <span class="n">fhs</span><span class="o">.</span><span class="n">sweep</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>     
                 
    <span class="n">fvs</span>        <span class="o">=</span> <span class="n">Data</span><span class="p">()</span> 
    <span class="n">fvs</span><span class="o">.</span><span class="n">origin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">fvs</span><span class="o">.</span><span class="n">chord</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> 
    <span class="n">fvs</span><span class="o">.</span><span class="n">sweep</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fus</span><span class="p">,</span> <span class="n">Fuselage</span><span class="p">):</span>

        <span class="c1"># Compute the curvature of the nose/tail given fineness ratio. Curvature is derived from general quadratic equation</span>
        <span class="c1"># This method relates the fineness ratio to the quadratic curve formula via a spline fit interpolation</span>
        <span class="n">vec1</span>               <span class="o">=</span> <span class="p">[</span><span class="mi">2</span> <span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.2</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">vec2</span>               <span class="o">=</span> <span class="p">[</span><span class="mi">1</span>  <span class="p">,</span><span class="mf">1.57</span> <span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span>  <span class="mi">8</span><span class="p">]</span>
        <span class="n">x</span>                  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">fus_nose_curvature</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">fus</span><span class="o">.</span><span class="n">fineness</span><span class="o">.</span><span class="n">nose</span><span class="p">,</span><span class="n">vec2</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="p">,</span> <span class="n">vec1</span><span class="p">)</span>
        <span class="n">fus_tail_curvature</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">fus</span><span class="o">.</span><span class="n">fineness</span><span class="o">.</span><span class="n">tail</span><span class="p">,</span><span class="n">vec2</span><span class="p">,</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="p">,</span> <span class="n">vec1</span><span class="p">)</span>
        <span class="n">semispan_h</span> <span class="o">=</span> <span class="n">fus</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mf">0.5</span>
        <span class="n">semispan_v</span> <span class="o">=</span> <span class="n">fus</span><span class="o">.</span><span class="n">heights</span><span class="o">.</span><span class="n">maximum</span> <span class="o">*</span> <span class="mf">0.5</span>
        <span class="n">si</span>         <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,((</span><span class="n">n_sw</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">spacing</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">si</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">si</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="n">h_array</span>    <span class="o">=</span> <span class="n">semispan_h</span><span class="o">*</span><span class="n">spacing</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">si</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">v_array</span>    <span class="o">=</span> <span class="n">semispan_v</span><span class="o">*</span><span class="n">spacing</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">si</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">fhs_cabin_length</span>  <span class="o">=</span> <span class="n">fus</span><span class="o">.</span><span class="n">lengths</span><span class="o">.</span><span class="n">total</span> <span class="o">-</span> <span class="p">(</span><span class="n">fus</span><span class="o">.</span><span class="n">lengths</span><span class="o">.</span><span class="n">nose</span> <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">lengths</span><span class="o">.</span><span class="n">tail</span><span class="p">)</span>
            <span class="n">fhs</span><span class="o">.</span><span class="n">nose_length</span>   <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">h_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">semispan_h</span><span class="p">))</span><span class="o">**</span><span class="n">fus_nose_curvature</span> <span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">fus_nose_curvature</span><span class="p">))</span><span class="o">*</span><span class="n">fus</span><span class="o">.</span><span class="n">lengths</span><span class="o">.</span><span class="n">nose</span>
            <span class="n">fhs</span><span class="o">.</span><span class="n">tail_length</span>   <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">h_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">semispan_h</span><span class="p">))</span><span class="o">**</span><span class="n">fus_tail_curvature</span> <span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">fus_tail_curvature</span><span class="p">))</span><span class="o">*</span><span class="n">fus</span><span class="o">.</span><span class="n">lengths</span><span class="o">.</span><span class="n">tail</span>
            <span class="n">fhs</span><span class="o">.</span><span class="n">nose_origin</span>   <span class="o">=</span> <span class="n">fus</span><span class="o">.</span><span class="n">lengths</span><span class="o">.</span><span class="n">nose</span> <span class="o">-</span> <span class="n">fhs</span><span class="o">.</span><span class="n">nose_length</span>
            <span class="n">fhs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">i</span><span class="p">][:]</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fhs</span><span class="o">.</span><span class="n">nose_origin</span> <span class="p">,</span> <span class="n">h_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mf">0.</span><span class="p">])</span> <span class="c1"># Local origin</span>
            <span class="n">fhs</span><span class="o">.</span><span class="n">chord</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>      <span class="o">=</span> <span class="n">fhs_cabin_length</span> <span class="o">+</span> <span class="n">fhs</span><span class="o">.</span><span class="n">nose_length</span> <span class="o">+</span> <span class="n">fhs</span><span class="o">.</span><span class="n">tail_length</span>

            <span class="n">fvs_cabin_length</span>  <span class="o">=</span> <span class="n">fus</span><span class="o">.</span><span class="n">lengths</span><span class="o">.</span><span class="n">total</span> <span class="o">-</span> <span class="p">(</span><span class="n">fus</span><span class="o">.</span><span class="n">lengths</span><span class="o">.</span><span class="n">nose</span> <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">lengths</span><span class="o">.</span><span class="n">tail</span><span class="p">)</span>
            <span class="n">fvs</span><span class="o">.</span><span class="n">nose_length</span>   <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">v_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">semispan_v</span><span class="p">))</span><span class="o">**</span><span class="n">fus_nose_curvature</span> <span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">fus_nose_curvature</span><span class="p">))</span><span class="o">*</span><span class="n">fus</span><span class="o">.</span><span class="n">lengths</span><span class="o">.</span><span class="n">nose</span>
            <span class="n">fvs</span><span class="o">.</span><span class="n">tail_length</span>   <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">v_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">semispan_v</span><span class="p">))</span><span class="o">**</span><span class="n">fus_tail_curvature</span> <span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">fus_tail_curvature</span><span class="p">))</span><span class="o">*</span><span class="n">fus</span><span class="o">.</span><span class="n">lengths</span><span class="o">.</span><span class="n">tail</span>
            <span class="n">fvs</span><span class="o">.</span><span class="n">nose_origin</span>   <span class="o">=</span> <span class="n">fus</span><span class="o">.</span><span class="n">lengths</span><span class="o">.</span><span class="n">nose</span> <span class="o">-</span> <span class="n">fvs</span><span class="o">.</span><span class="n">nose_length</span>
            <span class="n">fvs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">i</span><span class="p">][:]</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">fvs</span><span class="o">.</span><span class="n">nose_origin</span> <span class="p">,</span> <span class="n">origin</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">,</span> <span class="n">origin</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span>  <span class="n">v_array</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
            <span class="n">fvs</span><span class="o">.</span><span class="n">chord</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>      <span class="o">=</span> <span class="n">fvs_cabin_length</span> <span class="o">+</span> <span class="n">fvs</span><span class="o">.</span><span class="n">nose_length</span> <span class="o">+</span> <span class="n">fvs</span><span class="o">.</span><span class="n">tail_length</span>

        <span class="n">fhs</span><span class="o">.</span><span class="n">sweep</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">((</span><span class="n">fhs</span><span class="o">.</span><span class="n">origin</span><span class="p">[:,</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">fhs</span><span class="o">.</span><span class="n">origin</span><span class="p">[:,</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">fhs</span><span class="o">.</span><span class="n">origin</span><span class="p">[:,</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>  <span class="o">-</span> <span class="n">fhs</span><span class="o">.</span><span class="n">origin</span><span class="p">[:,</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span>
        <span class="n">fvs</span><span class="o">.</span><span class="n">sweep</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">((</span><span class="n">fvs</span><span class="o">.</span><span class="n">origin</span><span class="p">[:,</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">fvs</span><span class="o">.</span><span class="n">origin</span><span class="p">[:,</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">fvs</span><span class="o">.</span><span class="n">origin</span><span class="p">[:,</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>  <span class="o">-</span> <span class="n">fvs</span><span class="o">.</span><span class="n">origin</span><span class="p">[:,</span><span class="mi">2</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fus</span><span class="p">,</span> <span class="n">Nacelle</span><span class="p">):</span>
        <span class="n">num_nac_segs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fus</span><span class="o">.</span><span class="n">Segments</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">num_nac_segs</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">widths</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_nac_segs</span><span class="p">)</span>
            <span class="n">heights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_nac_segs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i_seg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_nac_segs</span><span class="p">):</span>
                <span class="n">widths</span><span class="p">[</span><span class="n">i_seg</span><span class="p">]</span>  <span class="o">=</span> <span class="n">fus</span><span class="o">.</span><span class="n">Segments</span><span class="p">[</span><span class="n">i_seg</span><span class="p">]</span><span class="o">.</span><span class="n">width</span>
                <span class="n">heights</span><span class="p">[</span><span class="n">i_seg</span><span class="p">]</span> <span class="o">=</span> <span class="n">fus</span><span class="o">.</span><span class="n">Segments</span><span class="p">[</span><span class="n">i_seg</span><span class="p">]</span><span class="o">.</span><span class="n">height</span>
            <span class="n">mean_width</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">widths</span><span class="p">)</span>
            <span class="n">mean_height</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">heights</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mean_width</span>   <span class="o">=</span> <span class="n">fus</span><span class="o">.</span><span class="n">diameter</span>
            <span class="n">mean_height</span>  <span class="o">=</span> <span class="n">fus</span><span class="o">.</span><span class="n">diameter</span>
        <span class="n">length</span> <span class="o">=</span> <span class="n">fus</span><span class="o">.</span><span class="n">length</span>

        <span class="c1"># geometry values</span>
        <span class="n">semispan_h</span> <span class="o">=</span> <span class="n">mean_width</span> <span class="o">*</span> <span class="mf">0.5</span>
        <span class="n">semispan_v</span> <span class="o">=</span> <span class="n">mean_height</span> <span class="o">*</span> <span class="mf">0.5</span>

        <span class="n">si</span>         <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,((</span><span class="n">n_sw</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">spacing</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">si</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">si</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="n">h_array</span>    <span class="o">=</span> <span class="n">semispan_h</span><span class="o">*</span><span class="n">spacing</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">si</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">v_array</span>    <span class="o">=</span> <span class="n">semispan_v</span><span class="o">*</span><span class="n">spacing</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">si</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">fhs</span><span class="o">.</span><span class="n">chord</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>      <span class="o">=</span> <span class="n">length</span>
            <span class="n">fvs</span><span class="o">.</span><span class="n">chord</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>      <span class="o">=</span> <span class="n">length</span>

    <span class="c1"># ---------------------------------------------------------------------------------------</span>
    <span class="c1"># STEP 9: Define coordinates of panels horseshoe vortices and control points  </span>
    <span class="c1"># ---------------------------------------------------------------------------------------        </span>
    <span class="n">fhs_eta_a</span> <span class="o">=</span> <span class="n">h_array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
    <span class="n">fhs_eta_b</span> <span class="o">=</span> <span class="n">h_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>            
    <span class="n">fhs_del_y</span> <span class="o">=</span> <span class="n">h_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">h_array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">fhs_eta</span>   <span class="o">=</span> <span class="n">h_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">fhs_del_y</span><span class="o">/</span><span class="mi">2</span>

    <span class="n">fvs_eta_a</span> <span class="o">=</span> <span class="n">v_array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
    <span class="n">fvs_eta_b</span> <span class="o">=</span> <span class="n">v_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>                  
    <span class="n">fvs_del_y</span> <span class="o">=</span> <span class="n">v_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">v_array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">fvs_eta</span>   <span class="o">=</span> <span class="n">v_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">fvs_del_y</span><span class="o">/</span><span class="mi">2</span> 

    <span class="n">fhs_cs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs</span><span class="o">.</span><span class="n">chord</span><span class="p">,</span><span class="n">fhs</span><span class="o">.</span><span class="n">chord</span><span class="p">])</span>
    <span class="n">fvs_cs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fvs</span><span class="o">.</span><span class="n">chord</span><span class="p">,</span><span class="n">fvs</span><span class="o">.</span><span class="n">chord</span><span class="p">])</span>
    
    <span class="n">fus_h_area</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">fus_v_area</span> <span class="o">=</span> <span class="mi">0</span>    

    <span class="c1"># define coordinates of horseshoe vortices and control points       </span>
    <span class="k">for</span> <span class="n">idx_y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sw</span><span class="p">):</span>  
        <span class="n">idx_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span>

        <span class="c1"># fuselage horizontal section </span>
        <span class="n">delta_x_a</span> <span class="o">=</span> <span class="n">fhs</span><span class="o">.</span><span class="n">chord</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span><span class="o">/</span><span class="n">n_cw</span>      
        <span class="n">delta_x_b</span> <span class="o">=</span> <span class="n">fhs</span><span class="o">.</span><span class="n">chord</span><span class="p">[</span><span class="n">idx_y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">n_cw</span>    
        <span class="n">delta_x</span>   <span class="o">=</span> <span class="p">(</span><span class="n">fhs</span><span class="o">.</span><span class="n">chord</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span><span class="o">+</span><span class="n">fhs</span><span class="o">.</span><span class="n">chord</span><span class="p">[</span><span class="n">idx_y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n_cw</span><span class="p">)</span>

        <span class="n">fhs_xi_a1</span> <span class="o">=</span> <span class="n">fhs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_a</span><span class="o">*</span><span class="n">idx_x</span>                    <span class="c1"># x coordinate of top left corner of panel</span>
        <span class="n">fhs_xi_ah</span> <span class="o">=</span> <span class="n">fhs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_a</span><span class="o">*</span><span class="n">idx_x</span> <span class="o">+</span> <span class="n">delta_x_a</span><span class="o">*</span><span class="mf">0.25</span>   <span class="c1"># x coordinate of left corner of panel</span>
        <span class="n">fhs_xi_a2</span> <span class="o">=</span> <span class="n">fhs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_a</span><span class="o">*</span><span class="n">idx_x</span> <span class="o">+</span> <span class="n">delta_x_a</span>        <span class="c1"># x coordinate of bottom left corner of bound vortex </span>
        <span class="n">fhs_xi_ac</span> <span class="o">=</span> <span class="n">fhs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_a</span><span class="o">*</span><span class="n">idx_x</span> <span class="o">+</span> <span class="n">delta_x_a</span><span class="o">*</span><span class="mf">0.75</span>   <span class="c1"># x coordinate of bottom left corner of control point vortex  </span>
        <span class="n">fhs_xi_b1</span> <span class="o">=</span> <span class="n">fhs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_b</span><span class="o">*</span><span class="n">idx_x</span>                  <span class="c1"># x coordinate of top right corner of panel      </span>
        <span class="n">fhs_xi_bh</span> <span class="o">=</span> <span class="n">fhs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_b</span><span class="o">*</span><span class="n">idx_x</span> <span class="o">+</span> <span class="n">delta_x_b</span><span class="o">*</span><span class="mf">0.25</span> <span class="c1"># x coordinate of right corner of bound vortex         </span>
        <span class="n">fhs_xi_b2</span> <span class="o">=</span> <span class="n">fhs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_b</span><span class="o">*</span><span class="n">idx_x</span> <span class="o">+</span> <span class="n">delta_x_b</span>      <span class="c1"># x coordinate of bottom right corner of panel</span>
        <span class="n">fhs_xi_bc</span> <span class="o">=</span> <span class="n">fhs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_b</span><span class="o">*</span><span class="n">idx_x</span> <span class="o">+</span> <span class="n">delta_x_b</span><span class="o">*</span><span class="mf">0.75</span> <span class="c1"># x coordinate of bottom right corner of control point vortex         </span>
        <span class="n">fhs_xi_c</span>  <span class="o">=</span> <span class="p">(</span><span class="n">fhs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">fhs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>  <span class="o">+</span> <span class="n">delta_x</span><span class="o">*</span><span class="n">idx_x</span> <span class="o">+</span> <span class="n">delta_x</span><span class="o">*</span><span class="mf">0.75</span>   <span class="c1"># x coordinate three-quarter chord control point for each panel</span>
        <span class="n">fhs_xi_ch</span> <span class="o">=</span> <span class="p">(</span><span class="n">fhs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">fhs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>  <span class="o">+</span> <span class="n">delta_x</span><span class="o">*</span><span class="n">idx_x</span> <span class="o">+</span> <span class="n">delta_x</span><span class="o">*</span><span class="mf">0.25</span>   <span class="c1"># x coordinate center of bound vortex of each panel </span>


        <span class="n">fhs_xa1</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">fhs_xi_a1</span>                       <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  
        <span class="n">fhs_ya1</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span><span class="o">*</span><span class="n">fhs_eta_a</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span>  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  
        <span class="n">fhs_za1</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span>                  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">fhs_xa2</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">fhs_xi_a2</span>                       <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  
        <span class="n">fhs_ya2</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span><span class="o">*</span><span class="n">fhs_eta_a</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span>  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> 
        <span class="n">fhs_za2</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span>                  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>      
        <span class="n">fhs_xb1</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">fhs_xi_b1</span>                       <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  
        <span class="n">fhs_yb1</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span><span class="o">*</span><span class="n">fhs_eta_b</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span>  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> 
        <span class="n">fhs_zb1</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span>                  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">fhs_xb2</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">fhs_xi_b2</span>                       <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> 
        <span class="n">fhs_yb2</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span><span class="o">*</span><span class="n">fhs_eta_b</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span>  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> 
        <span class="n">fhs_zb2</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span>                  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>       
        <span class="n">fhs_xah</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">fhs_xi_ah</span>                       <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>   
        <span class="n">fhs_yah</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span><span class="o">*</span><span class="n">fhs_eta_a</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span>  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  
        <span class="n">fhs_zah</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span>                  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>             
        <span class="n">fhs_xbh</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">fhs_xi_bh</span>                       <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> 
        <span class="n">fhs_ybh</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span><span class="o">*</span><span class="n">fhs_eta_b</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span>  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  
        <span class="n">fhs_zbh</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span>                  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>    
        <span class="n">fhs_xch</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">fhs_xi_ch</span>                       <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  
        <span class="n">fhs_ych</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span><span class="o">*</span><span class="n">fhs_eta</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span>    <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>                
        <span class="n">fhs_zch</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span>                  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>     
        <span class="n">fhs_xc</span> <span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">fhs_xi_c</span>                        <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  
        <span class="n">fhs_yc</span> <span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span><span class="o">*</span><span class="n">fhs_eta</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span>    <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  
        <span class="n">fhs_zc</span> <span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span>                  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>       
        <span class="n">fhs_xac</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">fhs_xi_ac</span>                       <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  
        <span class="n">fhs_yac</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span><span class="o">*</span><span class="n">fhs_eta_a</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span>  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">fhs_zac</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span>                  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">fhs_xbc</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">fhs_xi_bc</span>                       <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  
        <span class="n">fhs_ybc</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span><span class="o">*</span><span class="n">fhs_eta_b</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span>  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>                             
        <span class="n">fhs_zbc</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span>                  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>              
        <span class="n">fhs_x</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">):(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_xi_a1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fhs_xi_a2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])])</span> <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  
        <span class="n">fhs_y</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">):(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">fhs_eta_a</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span>  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>                             
        <span class="n">fhs_z</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">):(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>                  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>

        <span class="c1"># fuselage vertical section                      </span>
        <span class="n">delta_x_a</span> <span class="o">=</span> <span class="n">fvs</span><span class="o">.</span><span class="n">chord</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span><span class="o">/</span><span class="n">n_cw</span>      
        <span class="n">delta_x_b</span> <span class="o">=</span> <span class="n">fvs</span><span class="o">.</span><span class="n">chord</span><span class="p">[</span><span class="n">idx_y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">n_cw</span>    
        <span class="n">delta_x</span>   <span class="o">=</span> <span class="p">(</span><span class="n">fvs</span><span class="o">.</span><span class="n">chord</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span><span class="o">+</span><span class="n">fvs</span><span class="o">.</span><span class="n">chord</span><span class="p">[</span><span class="n">idx_y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n_cw</span><span class="p">)</span>   

        <span class="n">fvs_xi_a1</span> <span class="o">=</span> <span class="n">fvs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_a</span><span class="o">*</span><span class="n">idx_x</span>                    <span class="c1"># z coordinate of top left corner of panel</span>
        <span class="n">fvs_xi_ah</span> <span class="o">=</span> <span class="n">fvs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_a</span><span class="o">*</span><span class="n">idx_x</span> <span class="o">+</span> <span class="n">delta_x_a</span><span class="o">*</span><span class="mf">0.25</span>   <span class="c1"># z coordinate of left corner of panel</span>
        <span class="n">fvs_xi_a2</span> <span class="o">=</span> <span class="n">fvs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_a</span><span class="o">*</span><span class="n">idx_x</span> <span class="o">+</span> <span class="n">delta_x_a</span>        <span class="c1"># z coordinate of bottom left corner of bound vortex </span>
        <span class="n">fvs_xi_ac</span> <span class="o">=</span> <span class="n">fvs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_a</span><span class="o">*</span><span class="n">idx_x</span> <span class="o">+</span> <span class="n">delta_x_a</span><span class="o">*</span><span class="mf">0.75</span>   <span class="c1"># z coordinate of bottom left corner of control point vortex  </span>
        <span class="n">fvs_xi_b1</span> <span class="o">=</span> <span class="n">fvs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_b</span><span class="o">*</span><span class="n">idx_x</span>                    <span class="c1"># z coordinate of top right corner of panel      </span>
        <span class="n">fvs_xi_bh</span> <span class="o">=</span> <span class="n">fvs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_b</span><span class="o">*</span><span class="n">idx_x</span> <span class="o">+</span> <span class="n">delta_x_b</span><span class="o">*</span><span class="mf">0.25</span>   <span class="c1"># z coordinate of right corner of bound vortex         </span>
        <span class="n">fvs_xi_b2</span> <span class="o">=</span> <span class="n">fvs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_b</span><span class="o">*</span><span class="n">idx_x</span> <span class="o">+</span> <span class="n">delta_x_b</span>        <span class="c1"># z coordinate of bottom right corner of panel</span>
        <span class="n">fvs_xi_bc</span> <span class="o">=</span> <span class="n">fvs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta_x_b</span><span class="o">*</span><span class="n">idx_x</span> <span class="o">+</span> <span class="n">delta_x_b</span><span class="o">*</span><span class="mf">0.75</span>   <span class="c1"># z coordinate of bottom right corner of control point vortex         </span>
        <span class="n">fvs_xi_c</span>  <span class="o">=</span> <span class="p">(</span><span class="n">fvs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">fvs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">delta_x</span> <span class="o">*</span><span class="n">idx_x</span> <span class="o">+</span> <span class="n">delta_x</span><span class="o">*</span><span class="mf">0.75</span>     <span class="c1"># z coordinate three-quarter chord control point for each panel</span>
        <span class="n">fvs_xi_ch</span> <span class="o">=</span> <span class="p">(</span><span class="n">fvs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">fvs</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">delta_x</span> <span class="o">*</span><span class="n">idx_x</span> <span class="o">+</span> <span class="n">delta_x</span><span class="o">*</span><span class="mf">0.25</span>     <span class="c1"># z coordinate center of bound vortex of each panel </span>

        <span class="n">fvs_xc</span> <span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">fvs_xi_c</span>                       <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  
        <span class="n">fvs_zc</span> <span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span><span class="o">*</span><span class="n">fvs_eta</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span>   <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>  
        <span class="n">fvs_yc</span> <span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="n">n_cw</span><span class="p">:(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="p">)</span>                 <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  
        <span class="n">fvs_x</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">):(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fvs_xi_a1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fvs_xi_a2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])])</span> <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  
        <span class="n">fvs_z</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">):(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">fvs_eta_a</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span> <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>               
        <span class="n">fvs_y</span><span class="p">[</span><span class="n">idx_y</span><span class="o">*</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">):(</span><span class="n">idx_y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>                 <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="n">fus_h_area</span> <span class="o">+=</span> <span class="p">((</span><span class="n">fhs</span><span class="o">.</span><span class="n">chord</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span><span class="o">+</span><span class="n">fhs</span><span class="o">.</span><span class="n">chord</span><span class="p">[</span><span class="n">idx_y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fhs_eta_b</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span> <span class="o">-</span> <span class="n">fhs_eta_a</span><span class="p">[</span><span class="n">idx_y</span><span class="p">])</span>
        <span class="n">fus_v_area</span> <span class="o">+=</span> <span class="p">((</span><span class="n">fvs</span><span class="o">.</span><span class="n">chord</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span><span class="o">+</span><span class="n">fvs</span><span class="o">.</span><span class="n">chord</span><span class="p">[</span><span class="n">idx_y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">fvs_eta_b</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span> <span class="o">-</span> <span class="n">fvs_eta_a</span><span class="p">[</span><span class="n">idx_y</span><span class="p">])</span>
        
        <span class="c1"># store this strip&#39;s discretization information</span>
        <span class="n">LE_inds</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">n_cw</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">TE_inds</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">n_cw</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">LE_inds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>     <span class="o">=</span> <span class="kc">True</span>
        <span class="n">TE_inds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>    <span class="o">=</span> <span class="kc">True</span>
        
        <span class="n">RNMAX</span>          <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span><span class="o">*</span><span class="n">n_cw</span>
        <span class="n">panel_numbers</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n_cw</span><span class="p">,</span><span class="n">n_cw</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
        
        <span class="n">leading_edge_indices</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leading_edge_indices</span>   <span class="p">,</span> <span class="n">LE_inds</span>       <span class="p">)</span> 
        <span class="n">trailing_edge_indices</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trailing_edge_indices</span>  <span class="p">,</span> <span class="n">TE_inds</span>       <span class="p">)</span>            
        <span class="n">panels_per_strip</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">panels_per_strip</span>       <span class="p">,</span> <span class="n">RNMAX</span>         <span class="p">)</span>
        <span class="n">chordwise_panel_number</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chordwise_panel_number</span> <span class="p">,</span> <span class="n">panel_numbers</span> <span class="p">)</span>       

    <span class="c1"># xyz positions for the right side of this fuselage&#39;s outermost panels</span>
    <span class="n">fhs_x</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_xi_b1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fhs_xi_b2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])])</span><span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  
    <span class="n">fhs_y</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">fhs_eta_b</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span>  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>                             
    <span class="n">fhs_z</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>                  <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>        
    <span class="n">fvs_x</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fvs_xi_a1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fvs_xi_a2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])])</span> <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  
    <span class="n">fvs_z</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">fvs_eta_a</span><span class="p">[</span><span class="n">idx_y</span><span class="p">]</span> <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>               
    <span class="n">fvs_y</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">):]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>                 <span class="o">+</span> <span class="n">fus</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>   
    <span class="n">fhs_cs</span> <span class="o">=</span>  <span class="p">(</span><span class="n">fhs</span><span class="o">.</span><span class="n">chord</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">fhs</span><span class="o">.</span><span class="n">chord</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">fvs_cs</span> <span class="o">=</span>  <span class="p">(</span><span class="n">fvs</span><span class="o">.</span><span class="n">chord</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">fvs</span><span class="o">.</span><span class="n">chord</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">/</span><span class="mi">2</span>     

    <span class="c1"># Horizontal Fuselage Sections </span>
    <span class="n">wing_areas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">wing_areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fus_h_area</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
    <span class="n">wing_areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fus_h_area</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
    
    <span class="c1"># store points of horizontal section of fuselage </span>
    <span class="n">fhs_cs</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_cs</span><span class="p">,</span> <span class="n">fhs_cs</span><span class="p">])</span>
    <span class="n">fhs_xah</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_xah</span><span class="p">,</span> <span class="n">fhs_xah</span><span class="p">])</span>
    <span class="n">fhs_yah</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_yah</span><span class="p">,</span><span class="o">-</span><span class="n">fhs_yah</span><span class="p">])</span>
    <span class="n">fhs_zah</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_zah</span><span class="p">,</span> <span class="n">fhs_zah</span><span class="p">])</span>
    <span class="n">fhs_xbh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_xbh</span><span class="p">,</span> <span class="n">fhs_xbh</span><span class="p">])</span>
    <span class="n">fhs_ybh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_ybh</span><span class="p">,</span><span class="o">-</span><span class="n">fhs_ybh</span><span class="p">])</span>
    <span class="n">fhs_zbh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_zbh</span><span class="p">,</span> <span class="n">fhs_zbh</span><span class="p">])</span>
    <span class="n">fhs_xch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_xch</span><span class="p">,</span> <span class="n">fhs_xch</span><span class="p">])</span>
    <span class="n">fhs_ych</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_ych</span><span class="p">,</span><span class="o">-</span><span class="n">fhs_ych</span><span class="p">])</span>
    <span class="n">fhs_zch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_zch</span><span class="p">,</span> <span class="n">fhs_zch</span><span class="p">])</span>
    <span class="n">fhs_xa1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_xa1</span><span class="p">,</span> <span class="n">fhs_xa1</span><span class="p">])</span>
    <span class="n">fhs_ya1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_ya1</span><span class="p">,</span><span class="o">-</span><span class="n">fhs_ya1</span><span class="p">])</span>
    <span class="n">fhs_za1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_za1</span><span class="p">,</span> <span class="n">fhs_za1</span><span class="p">])</span>
    <span class="n">fhs_xa2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_xa2</span><span class="p">,</span> <span class="n">fhs_xa2</span><span class="p">])</span>
    <span class="n">fhs_ya2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_ya2</span><span class="p">,</span><span class="o">-</span><span class="n">fhs_ya2</span><span class="p">])</span>
    <span class="n">fhs_za2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_za2</span><span class="p">,</span> <span class="n">fhs_za2</span><span class="p">])</span>
    <span class="n">fhs_xb1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_xb1</span><span class="p">,</span> <span class="n">fhs_xb1</span><span class="p">])</span>
    <span class="n">fhs_yb1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_yb1</span><span class="p">,</span><span class="o">-</span><span class="n">fhs_yb1</span><span class="p">])</span>    
    <span class="n">fhs_zb1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_zb1</span><span class="p">,</span> <span class="n">fhs_zb1</span><span class="p">])</span>
    <span class="n">fhs_xb2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_xb2</span><span class="p">,</span> <span class="n">fhs_xb2</span><span class="p">])</span>
    <span class="n">fhs_yb2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_yb2</span><span class="p">,</span><span class="o">-</span><span class="n">fhs_yb2</span><span class="p">])</span>            
    <span class="n">fhs_zb2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_zb2</span><span class="p">,</span> <span class="n">fhs_zb2</span><span class="p">])</span>
    <span class="n">fhs_xac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_xac</span><span class="p">,</span> <span class="n">fhs_xac</span><span class="p">])</span>
    <span class="n">fhs_yac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_yac</span><span class="p">,</span><span class="o">-</span><span class="n">fhs_yac</span><span class="p">])</span>
    <span class="n">fhs_zac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_zac</span><span class="p">,</span> <span class="n">fhs_zac</span><span class="p">])</span>            
    <span class="n">fhs_xbc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_xbc</span><span class="p">,</span> <span class="n">fhs_xbc</span><span class="p">])</span>
    <span class="n">fhs_ybc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_ybc</span><span class="p">,</span><span class="o">-</span><span class="n">fhs_ybc</span><span class="p">])</span>
    <span class="n">fhs_zbc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_zbc</span><span class="p">,</span> <span class="n">fhs_zbc</span><span class="p">])</span>
    <span class="n">fhs_xc</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_xc</span> <span class="p">,</span> <span class="n">fhs_xc</span> <span class="p">])</span>
    <span class="n">fhs_yc</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_yc</span> <span class="p">,</span><span class="o">-</span><span class="n">fhs_yc</span><span class="p">])</span>
    <span class="n">fhs_zc</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_zc</span> <span class="p">,</span> <span class="n">fhs_zc</span> <span class="p">])</span>     
    <span class="n">fhs_x</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_x</span>  <span class="p">,</span> <span class="n">fhs_x</span>  <span class="p">])</span>
    <span class="n">fhs_y</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_y</span>  <span class="p">,</span><span class="o">-</span><span class="n">fhs_y</span> <span class="p">])</span>
    <span class="n">fhs_z</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">fhs_z</span>  <span class="p">,</span> <span class="n">fhs_z</span>  <span class="p">])</span>      
    
    <span class="k">if</span> <span class="n">model_geometry</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        
        <span class="c1"># increment fuslage lifting surface sections  </span>
        <span class="n">VD</span><span class="o">.</span><span class="n">n_fus</span>   <span class="o">+=</span> <span class="mi">2</span>    
        <span class="n">VD</span><span class="o">.</span><span class="n">n_cp</span>    <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fhs_xch</span><span class="p">)</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">n_w</span>     <span class="o">+=</span> <span class="mi">2</span> 
        <span class="n">VD</span><span class="o">.</span><span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="c1"># store this fuselage&#39;s discretization information </span>
        <span class="n">n_panels</span>         <span class="o">=</span> <span class="n">n_sw</span><span class="o">*</span><span class="n">n_cw</span>
        <span class="n">first_panel_ind</span>  <span class="o">=</span> <span class="n">VD</span><span class="o">.</span><span class="n">XAH</span><span class="o">.</span><span class="n">size</span>
        <span class="n">first_strip_ind</span>  <span class="o">=</span> <span class="p">[</span><span class="n">VD</span><span class="o">.</span><span class="n">chordwise_breaks</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">VD</span><span class="o">.</span><span class="n">chordwise_breaks</span><span class="o">.</span><span class="n">size</span><span class="o">+</span><span class="n">n_sw</span><span class="p">]</span>
        <span class="n">chordwise_breaks</span> <span class="o">=</span>  <span class="n">first_panel_ind</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">n_panels</span><span class="p">)[</span><span class="mi">0</span><span class="p">::</span><span class="n">n_cw</span><span class="p">]</span>        
        
        <span class="n">VD</span><span class="o">.</span><span class="n">chordwise_breaks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">chordwise_breaks</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">chordwise_breaks</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">spanwise_breaks</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">spanwise_breaks</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">first_strip_ind</span> <span class="p">))</span>            
        <span class="n">VD</span><span class="o">.</span><span class="n">n_sw</span>             <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">n_sw</span>            <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">([</span><span class="n">n_sw</span><span class="p">,</span> <span class="n">n_sw</span><span class="p">])</span>    <span class="p">)</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">n_cw</span>             <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">n_cw</span>            <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">([</span><span class="n">n_cw</span><span class="p">,</span> <span class="n">n_cw</span><span class="p">])</span>    <span class="p">)</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">surface_ID</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">surface_ID</span>      <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">fhs_xch</span><span class="p">))</span> <span class="o">*</span> <span class="n">VD</span><span class="o">.</span><span class="n">counter</span><span class="p">)</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">surface_ID_full</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">surface_ID_full</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(((</span><span class="n">n_sw</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n_cw</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">VD</span><span class="o">.</span><span class="n">counter</span><span class="p">)</span>
        
        <span class="n">VD</span><span class="o">.</span><span class="n">leading_edge_indices</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">leading_edge_indices</span>     <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">leading_edge_indices</span>        <span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">trailing_edge_indices</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">trailing_edge_indices</span>    <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">trailing_edge_indices</span>       <span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span>           
        <span class="n">VD</span><span class="o">.</span><span class="n">panels_per_strip</span>          <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">panels_per_strip</span>         <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">panels_per_strip</span>            <span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">chordwise_panel_number</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">chordwise_panel_number</span>   <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">chordwise_panel_number</span>      <span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span> 
        <span class="n">VD</span><span class="o">.</span><span class="n">exposed_leading_edge_flag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">exposed_leading_edge_flag</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_sw</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
        
        <span class="c1"># Store fus in vehicle vector  </span>
        <span class="n">VD</span><span class="o">.</span><span class="n">XAH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XAH</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_xah</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">YAH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YAH</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_yah</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">ZAH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZAH</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_zah</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">XBH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XBH</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_xbh</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">YBH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YBH</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_ybh</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">ZBH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZBH</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_zbh</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">XCH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XCH</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_xch</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">YCH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YCH</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_ych</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">ZCH</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZCH</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_zch</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">XA1</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XA1</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_xa1</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">YA1</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YA1</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_ya1</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">ZA1</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZA1</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_za1</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">XA2</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XA2</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_xa2</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">YA2</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YA2</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_ya2</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">ZA2</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZA2</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_za2</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">XB1</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XB1</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_xb1</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">YB1</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YB1</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_yb1</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">ZB1</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZB1</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_zb1</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">XB2</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XB2</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_xb2</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">YB2</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YB2</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_yb2</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">ZB2</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZB2</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_zb2</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">XAC</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XAC</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_xac</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">YAC</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YAC</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_yac</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">ZAC</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZAC</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_zac</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">XBC</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XBC</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_xbc</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">YBC</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YBC</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_ybc</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">ZBC</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZBC</span>  <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_zbc</span>  <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">XC</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">XC</span>   <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_xc</span>   <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">YC</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">YC</span>   <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_yc</span>   <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">ZC</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">ZC</span>   <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_zc</span>   <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">CS</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">CS</span>   <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_cs</span>   <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">X</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">X</span>    <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_x</span>    <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">Y</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">Y</span>    <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_y</span>    <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        <span class="n">VD</span><span class="o">.</span><span class="n">Z</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">Z</span>    <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fhs_z</span>    <span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">precision</span><span class="p">))</span>
        
        <span class="n">VD</span><span class="o">.</span><span class="n">wing_areas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VD</span><span class="o">.</span><span class="n">wing_areas</span><span class="p">,</span> <span class="n">wing_areas</span><span class="p">)</span>
        
        <span class="n">VL</span> <span class="o">=</span> <span class="n">VD</span><span class="o">.</span><span class="n">vortex_lift</span>
        <span class="n">VL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">VL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    
    
    <span class="k">return</span> <span class="n">VD</span></div>




<span class="k">def</span> <span class="nf">_generate_vortex_distribution</span><span class="p">(</span><span class="n">State</span><span class="p">,</span> <span class="n">Settings</span><span class="p">,</span> <span class="n">System</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Framework version of generate_vortex_distribution.</span>
<span class="sd">	Wraps generate_vortex_distribution with State, Settings, System pack/unpack.</span>
<span class="sd">	Please see generate_vortex_distribution documentation for more details.</span>
<span class="sd">	&#39;&#39;&#39;</span>

	<span class="c1">#TODO: geometry = [Replace With State, Settings, or System Attribute]</span>
	<span class="c1">#TODO: settings = [Replace With State, Settings, or System Attribute]</span>

	<span class="n">results</span> <span class="o">=</span> <span class="n">generate_vortex_distribution</span><span class="p">(</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="s1">&#39;settings&#39;</span><span class="p">)</span>
	<span class="c1">#TODO: [Replace results with the output of the original function]</span>

	<span class="n">State</span><span class="p">,</span> <span class="n">Settings</span><span class="p">,</span> <span class="n">System</span> <span class="o">=</span> <span class="n">results</span>
	<span class="c1">#TODO: [Replace packing with correct attributes]</span>

	<span class="k">return</span> <span class="n">State</span><span class="p">,</span> <span class="n">Settings</span><span class="p">,</span> <span class="n">System</span>


<span class="k">def</span> <span class="nf">_generate_wing_vortex_distribution</span><span class="p">(</span><span class="n">State</span><span class="p">,</span> <span class="n">Settings</span><span class="p">,</span> <span class="n">System</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Framework version of generate_wing_vortex_distribution.</span>
<span class="sd">	Wraps generate_wing_vortex_distribution with State, Settings, System pack/unpack.</span>
<span class="sd">	Please see generate_wing_vortex_distribution documentation for more details.</span>
<span class="sd">	&#39;&#39;&#39;</span>

	<span class="c1">#TODO: VD        = [Replace With State, Settings, or System Attribute]</span>
	<span class="c1">#TODO: wing      = [Replace With State, Settings, or System Attribute]</span>
	<span class="c1">#TODO: n_cw      = [Replace With State, Settings, or System Attribute]</span>
	<span class="c1">#TODO: n_sw      = [Replace With State, Settings, or System Attribute]</span>
	<span class="c1">#TODO: spc       = [Replace With State, Settings, or System Attribute]</span>
	<span class="c1">#TODO: precision = [Replace With State, Settings, or System Attribute]</span>

	<span class="n">results</span> <span class="o">=</span> <span class="n">generate_wing_vortex_distribution</span><span class="p">(</span><span class="s1">&#39;VD&#39;</span><span class="p">,</span> <span class="s1">&#39;wing&#39;</span><span class="p">,</span> <span class="s1">&#39;n_cw&#39;</span><span class="p">,</span> <span class="s1">&#39;n_sw&#39;</span><span class="p">,</span> <span class="s1">&#39;spc&#39;</span><span class="p">,</span> <span class="s1">&#39;precision&#39;</span><span class="p">)</span>
	<span class="c1">#TODO: [Replace results with the output of the original function]</span>

	<span class="n">State</span><span class="p">,</span> <span class="n">Settings</span><span class="p">,</span> <span class="n">System</span> <span class="o">=</span> <span class="n">results</span>
	<span class="c1">#TODO: [Replace packing with correct attributes]</span>

	<span class="k">return</span> <span class="n">State</span><span class="p">,</span> <span class="n">Settings</span><span class="p">,</span> <span class="n">System</span>


<span class="k">def</span> <span class="nf">_generate_fuselage_and_nacelle_vortex_distribution</span><span class="p">(</span><span class="n">State</span><span class="p">,</span> <span class="n">Settings</span><span class="p">,</span> <span class="n">System</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">	Framework version of generate_fuselage_and_nacelle_vortex_distribution.</span>
<span class="sd">	Wraps generate_fuselage_and_nacelle_vortex_distribution with State, Settings, System pack/unpack.</span>
<span class="sd">	Please see generate_fuselage_and_nacelle_vortex_distribution documentation for more details.</span>
<span class="sd">	&#39;&#39;&#39;</span>

	<span class="c1">#TODO: VD             = [Replace With State, Settings, or System Attribute]</span>
	<span class="c1">#TODO: fus            = [Replace With State, Settings, or System Attribute]</span>
	<span class="c1">#TODO: n_cw           = [Replace With State, Settings, or System Attribute]</span>
	<span class="c1">#TODO: n_sw           = [Replace With State, Settings, or System Attribute]</span>
	<span class="c1">#TODO: precision      = [Replace With State, Settings, or System Attribute]</span>
	<span class="c1">#TODO: model_geometry = [Replace With State, Settings, or System Attribute]</span>

	<span class="n">results</span> <span class="o">=</span> <span class="n">generate_fuselage_and_nacelle_vortex_distribution</span><span class="p">(</span><span class="s1">&#39;VD&#39;</span><span class="p">,</span> <span class="s1">&#39;fus&#39;</span><span class="p">,</span> <span class="s1">&#39;n_cw&#39;</span><span class="p">,</span> <span class="s1">&#39;n_sw&#39;</span><span class="p">,</span> <span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="s1">&#39;model_geometry&#39;</span><span class="p">)</span>
	<span class="c1">#TODO: [Replace results with the output of the original function]</span>

	<span class="n">State</span><span class="p">,</span> <span class="n">Settings</span><span class="p">,</span> <span class="n">System</span> <span class="o">=</span> <span class="n">results</span>
	<span class="c1">#TODO: [Replace packing with correct attributes]</span>

	<span class="k">return</span> <span class="n">State</span><span class="p">,</span> <span class="n">Settings</span><span class="p">,</span> <span class="n">System</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Aerospace Research Community LLC.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>